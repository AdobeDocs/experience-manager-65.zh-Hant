---
title: 設定商務行事曆
description: 商務行事曆定義貴組織的商務日與非商務日。 瞭解如何設定企業行事曆。
contentOwner: admin
content-type: reference
geptopics: SG_AEMFORMS/categories/configuring_forms_workflow
products: SG_EXPERIENCEMANAGER/6.5/FORMS
exl-id: 4282718a-41f1-411a-9cd7-8c470005107d
solution: Experience Manager, Experience Manager Forms
role: User, Developer
source-git-commit: f6771bd1338a4e27a48c3efd39efe18e57cb98f9
workflow-type: tm+mt
source-wordcount: '1889'
ht-degree: 0%

---

# 設定商務行事曆 {#configuring-business-calendars}

*商務行事曆* 為您的組織定義營業日與非營業日（例如，法定假日、週末及公司關機日）。 使用商業行事曆時，AEM表單會在執行某些日期計算時略過非商業日。 在Workbench中，您可以指定是否將商業行事曆用於與使用者相關的事件（例如工作提醒、截止日期和升級），或用於與使用者無關的動作（例如計時器事件和等待服務）。

例如，任務提醒設定為在任務指派給使用者後的三個工作天發生。 任務會在星期四指派。 不過，接下來的三天不是工作日，因為星期五是國定假日，接下來的兩天是週末日。 因此，提醒會在下週的星期三傳送。

>[!NOTE]
>
>使用商業行事曆計算日期和時間時，AEM Forms會使用執行所在伺服器的日期和時間，不會調整時區之間的差異。 例如，如果工作提醒排程在倫敦執行之伺服器上的上午10:00，但收到提醒的使用者位於紐約市，則使用者將於當地時間上午5:00收到提醒。

## 使用預設商務行事曆 {#using-the-default-business-calendar}

AEM forms提供預設的商業行事曆(名為 *內建行事曆*)將星期六和星期日指定為非工作日。 如果您組織中的所有使用者都有相同的非營業日，您可以更新預設的商務行事曆以符合您的組織。 僅使用預設業務行事曆時，您不需要在「使用者管理」中啟用業務行事曆或提供任何對應。 若未定義其他業務行事曆，AEM表單會使用預設的業務行事曆。

## 設定多個商務行事曆 {#setting-up-multiple-business-calendars}

如果您組織中的某些使用者擁有不同的非營業日，您可以定義多個營業行事曆並設定對應，以允許使用者對營業行事曆執行階段解析。

### 定義多個商務行事曆 {#define-multiple-business-calendars}

1. 決定如何將適當的商務行事曆與使用者建立關聯。 將商務行事曆與使用者建立關聯的方式有兩種：

   **群組成員資格：** 您可以根據使用者的群組成員資格，將業務行事曆指派給使用者。 在這種情況下，群組中的每位使用者將使用相同的商務行事曆。

   如果使用者是兩個不同群組的成員，且這些群組對應至兩個不同的業務行事曆，AEM表單將使用其在搜尋結果中找到的第一個行事曆。 在此情況下，請考慮使用商務行事曆索引鍵來將使用者與商務行事曆建立關聯。

   **商務行事曆索引鍵：** 您可以根據商業行事曆索引鍵將商業行事曆指派給使用者，商業行事曆索引鍵是在「使用者管理」中指定的設定。 然後，將商務行事曆索引鍵對應至表單工作流程中的商務行事曆。

   指派商務行事曆金鑰給使用者的方式取決於您是使用企業、本機或混合式網域。 如需設定網域的詳細資訊，請參閱 [新增網域](/help/forms/using/admin-help/adding-domains.md#adding-domains).

   如果您使用本機或混合式網域，有關使用者的資訊只會儲存在「使用者管理」資料庫中。 若要為這些使用者設定商務行事曆索引鍵，請在「使用者管理」中新增或編輯使用者時，於「商務行事曆索引鍵」欄位中輸入字串。 (請參閱 [新增和設定使用者](/help/forms/using/admin-help/adding-configuring-users.md#adding-and-configuring-users).) 然後，將商務行事曆索引鍵（字串）對應至表單工作流程中的商務行事曆。 (請參閱 [將使用者和群組對應至商務行事曆](configuring-business-calendars.md#mapping-users-and-groups-to-a-business-calendar).)

   如果您使用企業網域，有關使用者的資訊會儲存在協力廠商儲存系統中，例如「使用者管理」與「使用者管理」資料庫同步的LDAP目錄。 這可讓您將商務行事曆索引鍵對應到LDAP目錄中的欄位。 例如，如果目錄中的每個使用者記錄都包含「國家/地區」欄位，而您想要根據使用者所在的國家/地區來指派商務行事曆，請在指定目錄的使用者設定時，在「商務行事曆索引鍵」欄位中指定「國家/地區」欄位名稱。 (請參閱 [設定目錄](/help/forms/using/admin-help/configuring-directories.md#configuring-directories).) 然後，您可以將商務行事曆索引鍵（在LDAP目錄中為「國家/地區」欄位定義的值）對應至表單工作流程中的商務行事曆。 (請參閱 [將使用者和群組對應至商務行事曆](configuring-business-calendars.md#mapping-users-and-groups-to-a-business-calendar).)

1. 在表單工作流程中，為共用相同非營業日的每一組使用者定義一個行事曆。 (請參閱 [建立或更新商務行事曆](configuring-business-calendars.md#create-or-update-a-business-calendar).)
1. 在表單工作流程中，對應每個行事曆的業務行事曆索引鍵或群組成員資格。 (請參閱 [將使用者和群組對應至商務行事曆](configuring-business-calendars.md#mapping-users-and-groups-to-a-business-calendar).)
1. 在Workbench中，處理開發人員會選擇是否要使用業務工作歷來提醒、截止日期及升級。 (請參閱 [Workbench說明](https://www.adobe.com/go/learn_aemforms_workbench_63).)

   如果處理開發人員選擇使用商務行事曆，AEM Forms會根據「使用者管理」設定和「管理主控台」中定義的商務行事曆對應，動態選取適當的商務行事曆；如果不存在對應，則會使用預設行事曆。

   如果處理開發人員未使用商業行事曆，則事件的日期計算會將每天視為工作日。 例如，任務截止日期設定為在任務指派給使用者後的三天內。 任務會在星期四指派。 任務截止日期為星期日，即使為週末。

## 建立或更新商務行事曆 {#create-or-update-a-business-calendar}

如果您的組織包含具有不同非營業日之不同使用者集，您可以定義多個營業行事曆。 您也可以變更現有行事曆，包括AEM表單提供的預設內建行事曆。

>[!NOTE]
>
>如果您未建立商務行事曆，則會使用預設行事曆。

1. 在管理控制檯中，按一下「服務> Forms工作流程>企業行事曆」。
1. 若要新增商務行事曆，請按一下 ![bus_cal_plus](assets/bus_cal_plus.png). 文字 *新行事曆* 會出現在下拉式清單中。 選取文字，然後為您的行事曆輸入其他名稱。

   若要編輯現有的商務行事曆，請從下拉式清單中選取它。

1. 在預設非營業日底下，選取任何每週非營業日，例如週末。
1. [可選] 選取使用營業時間，並指定營業日的開始和結束時間。

   如果您選取此選項，在指定時間範圍之前發生的事件會移至時間範圍的開頭，而在時間範圍之後發生的事件則會移至下一個營業日的開始時間。

   例如，假設某個使用者在星期二凌晨2:00被指派一項任務，而該任務的提醒已設定為兩個工作天。 如果沒有營業時間，提醒將會在星期四凌晨2:00發生。 如果營業時間設為上午8:00至下午5:00，則提醒會推送至星期四上午8:00。 若沒有營業時間，若在星期二下午6:00建立提醒事件，則會在星期四營業時間之後進行提醒。 若營業時間設定為上午8:00至下午5:00，提醒將會在星期五上午8:00進行。

1. 在左側的行事曆中，連按兩下任何其他非工作日，例如假日。 您無法選取過去的天數。 您選取的非營業日會出現在右側的清單中，而日期會在一行中出現兩次。 在左側選取日期，以輸入非營業日的名稱或說明。

   若要從清單中移除非營業日，請按一下 ![bus_cal_trash](assets/bus_cal_trash.png) 在日邊上。

1. [可選] 如果此行事曆是預設行事曆，請選取預設行事曆。 當使用者相關事件沒有其他行事曆對應存在，或沒有為「計時器事件」或「等待服務」指定商業行事曆時，就會使用預設行事曆。 您無法刪除預設行事曆。
1. 完成非工作日的定義後，選取「啟用行事曆」以啟用行事曆，然後按一下「儲存」。

   如果您更新現有的行事曆，新版本會立即生效，並用於所有商務行事曆計算，包括已在執行中的工作。

   >[!NOTE]
   >
   >如果您未啟用行事曆，則會使用預設行事曆。

## 將使用者和群組對應至商務行事曆 {#mapping-users-and-groups-to-a-business-calendar}

您可以使用兩種方法將業務行事曆與使用者建立關聯。 您可以根據商務行事曆索引鍵或根據使用者所屬的目錄群組，將商務行事曆指派給使用者。 您可以使用「對應」標籤來指定AEM表單將使用的方式，以及將商務行事曆索引鍵與群組對應至商務行事曆。 如需將商務行事曆索引鍵與使用者產生關聯的詳細資訊，請參閱 [設定多個商務行事曆](configuring-business-calendars.md#setting-up-multiple-business-calendars).

### 根據商務行事曆索引鍵將商務行事曆與使用者建立關聯 {#associate-business-calendars-with-users-based-on-business-calendar-keys}

1. 在管理控制檯中，按一下「服務>表單工作流程>企業行事曆」，然後按一下「對應」標籤。
1. 在系統將使用清單中，選取使用者管理員商務行事曆金鑰解析。
1. 選取顯示使用者管理員商務行事曆索引鍵。 系統會顯示一個清單，其中包含一組已在「使用者管理」中定義的唯一企業行事曆索引鍵。

   對於本機網域和混合網域，清單會顯示在「使用者管理」的「商務行事曆金鑰」欄位中輸入的值。 對於企業(LDAP)網域，清單會顯示從LDAP欄位傳回的唯一集合（例如，「國家/地區」），該欄位已在LDAP網域設定中設定。

   如果「使用者管理」管理員尚未定義任何商務行事曆索引鍵，則清單將為空白。

1. 針對UM商務行事曆索引鍵清單中的每個專案，選取一個行事曆。
1. 按一下「儲存」。

### 根據目錄服務群組將商務行事曆與使用者和群組建立關聯 {#associate-business-calendars-with-users-and-groups-based-on-directory-service-groups}

1. 在管理控制檯中，按一下「服務>表單工作流程>企業行事曆」，然後按一下「對應」標籤。
1. 在系統將使用清單中，選取由目錄伺服器定義的群組。
1. 在「對應」頁簽上，選取「顯示目錄服務群組」。 隨即顯示清單，其中包含已在「使用者管理」中定義的群組。 (請參閱 [目錄設定](/help/forms/using/admin-help/configuring-directories.md#directory-settings).)

   >[!NOTE]
   >
   >在Workbench中，如果您已設定「使用者」服務使用業務行事曆，且服務已指派給群組，則AEM Forms會使用此處指定的群組對應來解析群組的行事曆。 AEM forms一律會使用群組對應來解析群組的行事曆，即使您使用商務行事曆索引鍵來解析使用者的行事曆亦然。 如果找不到群組對應，則會使用預設的業務行事曆。

1. 針對「目錄服務群組」清單中的每個專案，選取行事曆。
1. 按一下「儲存」。

## 匯出和匯入商務行事曆 {#exporting-and-importing-business-calendars}

AEM表單可讓您匯出業務行事曆並將其匯入為XML檔案。 您可以使用此功能將行事曆從中繼系統移至生產系統。

>[!NOTE]
>
>此功能會匯出和匯入所有已定義的商務行事曆，包括AEM表單提供的預設商務行事曆。 與現有行事曆同名的匯入業務行事曆會覆寫現有行事曆。

### 匯出商務行事曆 {#export-business-calendars}

1. 在管理控制檯中，按一下「服務>表單工作流程>企業行事曆」。
1. 按一下「匯出」並儲存XML檔案。

### 匯入商務行事曆 {#import-business-calendars}

1. 在管理控制檯中，按一下「服務>表單工作流程>企業行事曆」。
1. 按一下「匯入」。
1. 選取包含已匯出之商務行事曆的XML檔案，然後按一下「開啟」。

## 刪除商務行事曆 {#delete-a-business-calendar}

您可以移除貴組織不再需要的任何企業行事曆。 如果您刪除仍對應至使用者和群組的商務行事曆，則會使用預設行事曆。

1. 在管理控制檯中，按一下「服務> Forms工作流程>企業行事曆」。
1. 選取行事曆。
1. 按一下「刪除」。
