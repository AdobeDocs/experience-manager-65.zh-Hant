---
title: 設定電子郵件端點
description: 瞭解如何設定電子郵件端點。 電子郵件端點可讓您透過傳送一或多個檔案至指定的電子郵件帳戶來叫用服務。
contentOwner: admin
content-type: reference
geptopics: SG_AEMFORMS/categories/managing_endpoints
products: SG_EXPERIENCEMANAGER/6.5/FORMS
exl-id: 33583a12-4f20-4146-baa4-c9854e454bbf
solution: Experience Manager, Experience Manager Forms
feature: Adaptive Forms
role: User, Developer
source-git-commit: e821be5233fd5f6688507096790d219d25903892
workflow-type: tm+mt
source-wordcount: '3796'
ht-degree: 0%

---

# 設定電子郵件端點 {#configuring-email-endpoints}

電子郵件端點可讓使用者透過傳送一或多個檔案（作為電子郵件附件）至指定的電子郵件帳戶來叫用服務。 電子郵件收件匣可作為附件的收集點。 此服務會監視收件匣並處理附件。 轉換的結果會轉送給端點中定義的使用者。

對於電子郵件端點，授權的使用者可以透過將檔案電子郵件傳送到適當帳戶來叫用程式。 結果將傳回給提交使用者（依預設）或端點設定中定義的使用者。

在設定電子郵件端點之前，請先建立POP3或IMAP電子郵件帳戶以供端點使用。 為每種轉換型別設定個別的帳戶。 例如，一個帳戶可設定為從傳入的檔案附件產生標準PDF檔案，而另一個帳戶則可設定為產生安全的PDF檔案。

>[!NOTE]
>
>每個電子郵件地址都必須僅對應至一個電子郵件端點。 您無法將多個電子郵件端點設定為單一電子郵件地址，即使其他電子郵件端點已停用。

所有電子郵件端點都設定有電子郵件收件匣的授權使用者名稱和密碼，這是叫用服務時必要的。 電子郵件帳戶受到其設定所在的郵件伺服器系統的保護。

如果您的使用者在檔案和轉換路徑名稱中傳送含有西歐語言字元的檔案，則他們必須使用支援所需編碼型別的電子郵件應用程式（Latin1 [ISO-8859-1]、西歐[Windows]或UTF-8）。 如需詳細資訊，請參閱應用程式伺服器的&#x200B;*安裝和部署AEM表單*&#x200B;檔案。

在設定電子郵件端點之前，請先設定電子郵件服務。 （請參閱[設定預設電子郵件端點設定](configuring-email-endpoints.md#configure-default-email-endpoint-settings)。） 電子郵件服務的設定引數有兩個用途：

* 設定所有電子郵件端點的共同屬性
* 為所有電子郵件端點提供預設值

## 設定電子郵件端點的SSL {#configure-ssl-for-an-email-endpoint}

您可以設定POP3、IMAP或SMTP為電子郵件端點使用安全通訊端層(SSL)。

1. 在電子郵件伺服器上，根據製造商的檔案為POP3、IMAP或SMTP啟用SSL。
1. 從電子郵件伺服器匯出使用者端憑證。
1. 使用keytool程式將使用者端憑證檔案匯入應用程式伺服器的Java虛擬機器器(JVM)憑證存放區。 此步驟的程式將取決於JVM和使用者端安裝路徑。

   例如，如果您在Microsoft Windows Server® 2003上使用預設的OracleWebLogic Server安裝（含JDK 1.5.0），請在命令提示字元中輸入下列文字：

   `keytool -import -file client_certificate -alias myalias -keystore BEA_HOME\jdk150_04\jre\security\cacerts`

1. 出現提示時，輸入密碼（Java的預設密碼為`changeit`）。 您將收到一則訊息，指出憑證已成功匯入。
1. 使用管理主控台將電子郵件端點新增至服務。
1. 在管理控制檯中建立電子郵件端點。 設定端點設定時，請為內送訊息選取「POP3/IMAP SSL已啟用」，為外寄訊息選取「SMTP SSL已啟用」，並相應地變更連線埠屬性。

>[!NOTE]
>
>提示：如果您在使用SSL時遇到問題，請使用電子郵件使用者端(例如Microsoft Outlook)來檢查其是否可以使用SSL存取電子郵件伺服器。 如果電子郵件使用者端無法存取電子郵件伺服器，則此問題與您的憑證或電子郵件伺服器的設定有關。

## 設定預設電子郵件端點設定 {#configure-default-email-endpoint-settings}

您可以使用「服務管理」頁面來設定所有電子郵件端點的共同屬性，並提供所有電子郵件端點的預設值。

若要讓表單工作流程接收及處理使用者傳入的電子郵件訊息，您必須為「完成任務」服務建立電子郵件端點。 此電子郵件端點需要其他設定，如[為完成工作服務建立電子郵件端點](configuring-email-endpoints.md#create-an-email-endpoint-for-the-complete-task-service)中所述。

### 變更電子郵件端點的預設值 {#change-the-default-values-for-email-endpoints}

1. 在Administration Console中，按一下「服務>應用程式和服務>服務管理」。
1. 在「服務管理」頁面上，按一下「電子郵件：1.0」（元件ID為com.adobe.idp.dsc.provider.service.email.Email）。
1. 在[Configuration]索引標籤上，指定預設的電子郵件端點設定，然後按一下[Save]。

### 預設電子郵件端點設定 {#default-email-endpoint-settings}

**Cron運算式：** Quartz用來排程輪詢輸入目錄的Cron運算式。

**重複間隔：**&#x200B;重複目錄輪詢的次數。 如果未在端點設定中指定此值，則預設的重複間隔為秒。 預設值為 10。此值不能小於10。

**重複計數：**&#x200B;輪詢輸入目錄的次數。 如果未在端點設定中指定此值，則使用預設的重複計數。 值為–1表示無限掃描目錄。 預設值為 -1。

**工作開始時的延遲：**&#x200B;工作開始掃描端點前的延遲預設值（以秒為單位）。 預設值為 0。

**批次大小：**&#x200B;每次掃描接收者處理的電子郵件數目，以獲得最佳效能。 值–1表示所有電子郵件。 預設值為 2。

**非同步：**&#x200B;將呼叫型別識別為非同步或同步。 暫時和同步處理程式只能同步叫用。 預設值為非同步。

**網域模式：**&#x200B;用來篩選傳入電子郵件的網域名稱模式。 例如，如果使用adobe.com，則只會處理來自adobe.com的電子郵件；會忽略來自其他網域的電子郵件。

**檔案模式：**&#x200B;提供者接受的傳入檔案附件模式。 這包括具有特定副檔名(&amp;amp；ast；.dat、&amp;amp；ast；.xml)、特定名稱（資料）以及名稱和副檔名中的複合運算式的檔案()。[d][aA]&#39;連線埠&#39;)。 預設值為&amp;amp；ast；。&amp;amp；ast；。

**成功工作的收件者：**&#x200B;用來傳送電子郵件以指出成功工作的一或多個電子郵件地址。 依預設，成功的工作訊息一律會傳送給初始工作的傳送者。 最多可支援100個收件者。 若要關閉此設定，請將此欄位留空。

**失敗工作的收件者：**&#x200B;用來傳送電子郵件以指出失敗工作的一或多個電子郵件地址。 依預設，失敗的工作訊息一律會傳送給傳送初始工作的傳送者。 最多可支援100個收件者。 若要關閉此設定，請將此欄位留空。

**收件匣主機：**&#x200B;要掃描的電子郵件提供者的收件匣主機名稱或IP位址。

**收件匣連線埠：**&#x200B;電子郵件提供者要掃描的收件匣連線埠號碼。 如果值為0，則會使用預設的IMAP或POP3連線埠。

**收件匣通訊協定：**&#x200B;電子郵件端點用來掃描收件匣的電子郵件通訊協定。 選項為IMAP或POP3。 收件匣主機郵件伺服器必須支援這些通訊協定。

**收件匣逾時：**&#x200B;指定端點嘗試連線至收件匣時，在取消之前等待的時間長度。 如果在達到逾時值之前未取得連線，將不會輪詢收件匣。

**收件匣使用者：**&#x200B;登入電子郵件帳戶所需的使用者名稱。 根據電子郵件伺服器和設定，此名稱可能只是電子郵件的使用者名稱部分，也可能是完整的電子郵件地址。

**收件匣密碼：**&#x200B;收件匣使用者的密碼。

**POP3/IMAP SSL已啟用：**&#x200B;選取時，會啟用SSL。

**SMTP主機：**&#x200B;電子郵件提供者用來傳送結果和錯誤訊息的郵件伺服器的主機名稱。 例如， mail.example.com。

**SMTP連線埠：**&#x200B;用來連線到郵件伺服器的連線埠。 預設值為 25。

**SMTP使用者：**&#x200B;電子郵件提供者在傳送電子郵件以取得結果及發生錯誤時所要使用的使用者帳戶。

**SMTP密碼：** SMTP帳戶的密碼。 有些郵件伺服器不需要SMTP密碼。

**寄件者：**&#x200B;用來傳送結果和錯誤的電子郵件通知的電子郵件地址(例如，user@company.com)。 如果您未指定「傳送來源」值，電子郵件伺服器會嘗試將「SMTP使用者」設定中指定的值與電子郵件伺服器上設定的預設網域結合，以決定電子郵件地址。 如果您的電子郵件伺服器沒有預設網域，而且您沒有指定[傳送來源]的值，則可能會發生錯誤。 若要確保電子郵件訊息具有正確的寄件者地址，請為「寄件者」設定指定值。

**已啟用SMTP SSL：**&#x200B;選取時，會啟用SMTP上的SSL。

**包含原始電子郵件內文作為附件：**&#x200B;依預設，當您傳送電子郵件至Forms伺服器時，郵件原始文字會包含在郵件內文中。 若要改為將文字加入為附件，請選取此選項。

**使用結果電子郵件的原始主旨列：**&#x200B;依預設，Forms伺服器會在傳送結果電子郵件訊息時，使用成功電子郵件主旨和錯誤電子郵件主旨設定中指定的值作為主旨列。 若要改用與傳送至伺服器之原始電子郵件相同的主旨列，請選取此選項。

**成功電子郵件主旨：**&#x200B;當您傳送電子郵件至電子郵件端點以開始或繼續程式後，您會收到來自AEM Forms伺服器的傳回電子郵件訊息。 如果電子郵件成功，您會收到一封成功電子郵件。 如果您的電子郵件失敗，您會收到一封失敗電子郵件，通知它失敗的原因。 此設定可讓您指定為此端點傳送的成功電子郵件訊息的主旨行。

**成功電子郵件內文：**&#x200B;可讓您指定為此端點傳送的成功電子郵件訊息內文。

**錯誤電子郵件主旨字首：**&#x200B;可讓您指定此端點所傳送之失敗電子郵件訊息主旨行開頭所使用的文字。

**錯誤電子郵件主旨：**&#x200B;可讓您指定為此端點傳送的失敗電子郵件訊息的主旨行。 此文字會顯示在「錯誤電子郵件主旨前置詞」之後。

**錯誤電子郵件內文：**&#x200B;可讓您指定為此端點傳送的失敗電子郵件訊息內文的第一行。

**電子郵件摘要資訊：**&#x200B;每個成功或失敗訊息都包含一個區段，其中包含您傳送至Forms伺服器的原始電子郵件文字。 此設定會指定該區段上方顯示的文字。

**建立/更新此端點之前先驗證收件匣：**&#x200B;選取此選項時，Forms伺服器會在建立端點之前檢查您的SMTP/POP3設定是否正確。 當您按一下[新增]時，會顯示一則訊息，說明收件匣帳戶是否有效。 如果未選取此選項，AEM Forms伺服器會在不驗證收件匣的情況下建立端點。

**字元集編碼：**&#x200B;用於電子郵件訊息的編碼格式。 預設值為UTF-8，日本以外的大多數使用者都會使用它。 日本環境中的使用者可以選擇ISO2022-JP。

**失敗的電子郵件傳送資料夾：**&#x200B;指定當SMTP郵件伺服器無法運作時，要儲存結果的目錄。

## 電子郵件端點設定 {#email-endpoint-settings}

使用下列設定來設定電子郵件端點。

**名稱：**&#x200B;識別端點的必要設定。 請勿包含&lt;字元，因為它會截斷Workspace中顯示的名稱。 如果您輸入URL作為端點的名稱，請確保其符合RFC1738中指定的語法規則。

**描述：**&#x200B;端點的描述。 請勿包含&lt;字元，因為它會截斷Workspace中顯示的說明。

**Cron運算式：**&#x200B;如果電子郵件必須使用cron運算式排程，請輸入cron運算式。

**重複計數：**&#x200B;電子郵件端點掃描資料夾或目錄的次數。 值–1表示無限掃描。 預設值為 -1。

**重複間隔：**&#x200B;接收者用來檢查內送郵件的掃描速率。

**工作啟動時的延遲：**&#x200B;排程器啟動後等待掃描的時間。

**批次大小：**&#x200B;每次掃描接收者處理的電子郵件數目，以獲得最佳效能。 值–1表示所有電子郵件。 預設值為 2。

**使用者名稱：**&#x200B;強制設定，也就是從電子郵件叫用目標服務時使用的使用者名稱。 預設值為SuperAdmin。

**網域名稱：**&#x200B;必要的設定，也就是使用者的網域。 預設值為DefaultDom。

**網域模式：**&#x200B;指定提供者接受的傳入電子郵件的網域模式。 例如，如果使用adobe.com，則只會處理來自adobe.com的電子郵件；而會忽略來自其他網域的電子郵件。

**檔案模式：**&#x200B;指定提供者接受的傳入檔案附件模式。 這包括具有特定副檔名(&amp;amp；ast；.dat、&amp;amp；ast；.xml)、特定名稱（資料）或名稱和副檔名中的複合運算式的檔案(&amp;amp；ast；)。[d][aA]&#39;連線埠&#39;)。

**成功工作的收件者：**&#x200B;傳送訊息以指示成功工作的電子郵件地址。 依預設，成功的工作訊息一律會傳送給寄件者。 如果您輸入寄件者，則會將電子郵件結果傳送給寄件者。 最多可支援100個收件者。 使用以逗號(，)分隔的電子郵件地址指定其他收件者。

若要關閉此設定，請將設定保留空白。 某些情況下，您會想要觸發程式，而不想要結果的電子郵件通知。

**失敗工作的收件者：**&#x200B;傳送訊息以指出失敗工作的電子郵件地址。 依預設，失敗的工作訊息一律會傳送給寄件者。 如果您輸入寄件者，則會將電子郵件結果傳送給寄件者。 最多可支援100個收件者。 使用以逗號(，)分隔的電子郵件地址指定其他收件者。

若要關閉此設定，請將設定保留空白。 某些情況下，您會想要觸發程式，而不想要結果的電子郵件通知。

**收件匣主機：**&#x200B;要掃描的電子郵件提供者的收件匣主機名稱或IP位址。

**收件匣連線埠：**&#x200B;電子郵件伺服器使用的連線埠。 POP3的預設值為110，IMAP的預設值為143。 如果啟用SSL，POP3的預設值為995，IMAP的預設值為993。

**收件匣通訊協定：**&#x200B;電子郵件端點用來掃描收件匣的電子郵件通訊協定。 值為IMAP或POP3。 收件匣主機郵件伺服器必須支援這些通訊協定。

**收件匣逾時：**&#x200B;電子郵件提供者等候收件匣回應的逾時（以秒為單位）。

**收件匣使用者：**&#x200B;登入電子郵件帳戶所需的使用者名稱。 根據電子郵件伺服器和設定，此值可能只是電子郵件的使用者名稱部分，也可能是完整的電子郵件地址。

**收件匣密碼：**&#x200B;收件匣使用者的密碼。

**已啟用POP3/IMAP SSL：**&#x200B;選取此設定以強制電子郵件提供者使用SSL掃描收件匣。 確定您的郵件伺服器支援SSL。

**SMTP主機：**&#x200B;電子郵件提供者用來傳送結果和錯誤訊息的郵件伺服器的主機名稱。

**SMTP連線埠：** SMTP連線埠的預設值為25。

**SMTP使用者：**&#x200B;電子郵件提供者在傳送結果和錯誤的電子郵件通知時所要使用的使用者帳戶。

**SMTP密碼：** SMTP帳戶的密碼。 有些郵件伺服器不需要SMTP密碼。

**寄件者：**&#x200B;用來傳送結果和錯誤的電子郵件通知的電子郵件地址(例如，user@company.com)。 如果您未指定「傳送來源」值，電子郵件伺服器會嘗試將「SMTP使用者」設定中指定的值與電子郵件伺服器上設定的預設網域結合，以決定電子郵件地址。 如果您的電子郵件伺服器沒有預設網域，而且您沒有指定[傳送來源]的值，則可能會發生錯誤。 若要確保電子郵件訊息具有正確的寄件者地址，請為「寄件者」設定指定值。

**已啟用SMTP SSL：**&#x200B;選取此設定以強制電子郵件提供者使用SSL掃描收件匣。 確定您的郵件伺服器支援SSL。

**失敗的電子郵件傳送資料夾：**&#x200B;指定當SMTP郵件伺服器無法運作時，要儲存結果的目錄。

**非同步：**&#x200B;設定為synchronous時，會處理所有輸入檔案並傳回單一回應。 設為非同步時，系統會針對已處理的每個檔案傳送回應。

例如，會為接受單一Word檔案並以PDF檔案傳回該檔案的服務建立電子郵件端點。 可以將電子郵件傳送到包含多(3)個Word檔案的端點收件匣。 處理全部三份檔案後，如果端點設定為同步，則會傳送單一回應電子郵件並附上全部三份檔案。 如果端點非同步，在每個Word檔案轉換為PDF後都會傳送回應電子郵件。 結果是三封電子郵件，每封都包含單一PDF附件。

預設值為非同步。

**將原始電子郵件內文加入為附件：**&#x200B;依預設，當您傳送電子郵件至Forms伺服器時，郵件原始文字會包含在郵件內文中。 若要改為將文字加入為附件，請選取此選項。

**在結果電子郵件中使用原始主旨列：**&#x200B;依預設，Forms伺服器會在傳送結果電子郵件訊息時，使用[成功電子郵件主旨]和[錯誤電子郵件主旨]設定中指定的值作為主旨列。 若要改用與傳送至伺服器之原始電子郵件相同的主旨列，請選取此選項。

**成功電子郵件主旨：**&#x200B;當您傳送電子郵件至電子郵件端點以開始或繼續程式後，您會收到來自AEM Forms伺服器的傳回電子郵件訊息。 如果電子郵件成功，您會收到一封成功電子郵件。 如果您的電子郵件失敗，您會收到一封失敗電子郵件，通知它失敗的原因。 此設定可讓您指定為此端點傳送的成功電子郵件訊息的主旨行。

**成功電子郵件內文：**&#x200B;可讓您指定為此端點傳送的成功電子郵件訊息內文。

**錯誤電子郵件主旨字首：**&#x200B;可讓您指定此端點所傳送之失敗電子郵件訊息主旨行開頭所使用的文字。

**錯誤電子郵件主旨：**&#x200B;可讓您指定為此端點傳送的失敗電子郵件訊息的主旨行。 此文字會顯示在「錯誤電子郵件主旨前置詞」之後。

**錯誤電子郵件內文：**&#x200B;可讓您指定為此端點傳送的失敗電子郵件訊息內文的第一行。

**電子郵件摘要資訊：**&#x200B;每個成功或失敗訊息都包含一個區段，其中包含您傳送至Forms伺服器的原始電子郵件文字。 此設定會指定該區段上方顯示的文字。

**建立/更新此端點之前先驗證收件匣：**&#x200B;選取此選項時，Forms伺服器會在建立端點之前檢查您的SMTP/POP3設定是否正確。 當您按一下[新增]時，會顯示一則訊息，說明收件匣帳戶是否有效。 如果未選取此選項，AEM Forms伺服器會在不驗證收件匣的情況下建立端點。

**作業名稱：**&#x200B;此設定是必要的。 可指派給電子郵件端點的操作清單。 您在此選取的作業會決定在「輸入引數對應」和「輸出引數對應」區段中顯示哪些欄位。

**輸入引數對應：**&#x200B;用來設定處理服務與作業所需的輸入。 兩種輸入型別為常值輸入和變數：

**常值：**&#x200B;電子郵件使用在顯示的欄位中輸入的值。

**變數：**&#x200B;您可以從電子郵件主旨、內文、標題或寄件者的電子郵件地址對應字串。 若要這麼做，請使用下列其中一個關鍵字： %SUBJECT%、%BODY%、%HEADER%或%SENDER%。 例如，如果您使用%SUBJECT%，則會使用電子郵件主旨內容作為輸入引數。 若要擷取附件，請輸入電子郵件端點可用來選取附加檔案的檔案模式。 例如，輸入&amp;amp；ast；.pdf會選取任何副檔名為.pdf的附加檔案。 輸入&amp;amp；ast；會選取任何附加的檔案。 輸入example.pdf會選取任何名為example.pdf的附加檔案。

**輸出引數對應：**&#x200B;用來設定服務和操作的輸出。 輸出引數對應值中的下列字元會在附件檔案名稱中展開：

**%F**&#x200B;代表來源檔案的檔名（不包括副檔名）。

**%E**&#x200B;代表來源檔案的副檔名。

任何反斜線(\)的出現位置都會取代為%%。

***注意&#x200B;**：如果服務要求訊息包含多個檔案附件，則您無法使用端點之輸出引數對應專案屬性的%F和%E引數。 如果服務回應傳回多個檔案附件，則無法為多個附件指定相同的檔案名稱。 如果您不遵循這些建議，叫用的服務會建立傳回檔案的名稱，而且這些名稱是不可預測的。*

可使用下列值：

**單一物件：**&#x200B;電子郵件提供者沒有來源資料夾目的地；結果會以附件傳回。 模式為Result/%F.ps，並傳回Result%%sourcefilename.ps作為檔案名稱附件。

**清單：**&#x200B;模式為Result/%F/，並傳回Result%%sourcefilename%%file1作為檔案名稱附件。

**對應：**&#x200B;模式為Result/%F/，而來源目的地為Result%%sourcefilename%%file1和Result%%sourcefilename%%file2。 如果對應包含多個物件，且模式為Result/%F.ps，則回應檔案附件為Result%%sourcefilename1.ps （輸出1）和Result%%sourcefilename2.ps （輸出2）。

## 建立Complete Task服務的電子郵件端點 {#create-an-email-endpoint-for-the-complete-task-service}

若要讓表單工作流程接收及處理使用者傳入的電子郵件訊息，您必須為「完成任務」服務建立電子郵件端點。

1. 在Administration Console中，按一下「服務>應用程式和服務>服務管理」。
1. 在「服務管理」頁面上，按一下「完成工作」服務。
1. 在「端點」標籤上，從下拉式清單中選取「電子郵件」，然後按一下「新增」。
1. 在「收件匣主機」方塊中，輸入郵件伺服器的主機名稱或IP位址。
1. 在「收件匣使用者」方塊中，輸入登入您為處理表單提交而建立的電子郵件帳戶所需的使用者名稱。 根據電子郵件伺服器和設定，此名稱可能只是電子郵件的使用者名稱部分，也可能是完整的電子郵件地址。
1. 在「收件匣密碼」方塊中，輸入「收件匣使用者」的密碼。
1. 在「SMTP主機」方塊中，輸入電子郵件提供者傳送結果和錯誤訊息的來源郵件伺服器的主機名稱或IP位址。
1. 在「SMTP使用者」方塊中，輸入電子郵件提供者在傳送電子郵件以發現結果和錯誤時要使用的使用者帳戶。 此使用者帳戶可與您用於「收件匣使用者」的值相同。
1. 在「SMTP密碼」方塊中，輸入SMTP帳戶的密碼。
1. 在「作業名稱」清單中，選取「呼叫」。
1. 在attachmentMap清單中，選取Variable並在相鄰方塊中輸入`*.*`。 這會將所有來自傳入郵件訊息的附件傳送至對應變數，以進行完成工作程式。
1. 在mailBody清單中，選取變數並在相鄰方塊中輸入`%BODY%`。
1. 在mailFrom清單中，選取Variable並在相鄰方塊中輸入`%SENDER%`。 這會將寄件者地址對應到[完成任務]處理資料。
1. 在結果方塊中，輸入`results`。 這會導致「完成任務」或「啟動處理」傳回結果字串。
1. 按一下「新增」。
