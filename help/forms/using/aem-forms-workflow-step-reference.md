---
title: Forms上以OSGi為中心的工作流程 — 步驟參考
seo-title: Forms上以OSGi為中心的工作流程 — 步驟參考
description: 以OSGi步驟為中心的Forms工作流程可讓您快速建立最適化表單工作流程。
seo-description: 以OSGi步驟為中心的Forms工作流程可讓您快速建立最適化表單工作流程。
uuid: 6f791c45-0e35-4c55-9106-5340caab94b7
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: publish
discoiquuid: f0a5588d-f210-4f04-bc35-b62834f90ab1
docset: aem65
exl-id: 470fcfda-dfde-437c-b539-d5af1e13a7d6
source-git-commit: aaafda59c63ea47c67ec974263013ead468df9cc
workflow-type: tm+mt
source-wordcount: '7268'
ht-degree: 0%

---

# Forms上以OSGi為中心的工作流程 — 步驟參考{#forms-centric-workflow-on-osgi-step-reference}

## Forms Workflow步驟 {#forms-workflow-steps}

Forms工作流程步驟會在AEM工作流程中執行AEM Forms專屬作業。 這些步驟可讓您在OSGi上快速建立以Forms為中心的最適化表單。 這些工作流可用於開發基本的審核和批准工作流、內部和跨防火牆業務流程。 您也可以使用Forms Workflow步驟來開始檔案服務、整合Adobe Sign簽章工作流程，以及執行其他AEM Forms作業。 您需要[AEM Forms附加元件](https://www.adobe.com/go/learn_aemforms_documentation_63)才能在工作流程中使用這些步驟。

## 分配任務步驟 {#assign-task-step}

分配任務步驟將建立一個任務並將其分配給用戶或組。 除了指定任務外，元件還指定任務的最適化表單或非互動式PDF。 需要最適化表單才能接受使用者的輸入，而非互動式PDF或只供審核工作流程使用的唯讀最適化表單。

您也可以使用元件來控制任務的行為。 例如，建立自動記錄文檔，將任務分配給特定的用戶或組，指定提交資料的路徑，指定要預先填入的資料路徑，並指定預設操作。 分配任務步驟具有以下屬性：

* **標題：** 任務的標題。標題會顯示在AEM收件匣中。
* **說明：** 說明任務中正在執行的操作。當您在共用開發環境中工作時，此資訊對於其他程式開發人員很實用。

* **縮圖路徑：** 任務縮圖的路徑。如果未指定路徑，則會針對最適化表單預設縮圖顯示，而針對「記錄檔案」，則會顯示預設圖示。
* **工作流程階段：** 工作流程可以有多個階段。這些階段會顯示在AEM收件匣中。 您可以在模型的屬性中定義這些階段（Sidekick >頁面>頁面屬性>階段）。
* **優先順序：** 選取的優先順序會顯示在AEM收件匣中。可用選項有高、中和低。 預設值為Medium。
* **到期日：** 指定任務標籤為逾期的天數或小時數。如果選擇&#x200B;**Off**，則任務永遠不會標籤為過期。 您也可以指定超時處理程式，以在任務逾期後執行特定任務。

* **天數：** 要完成任務的天數。將任務分配給用戶後計算的天數。 如果任務未完成，且越過「天」欄位中指定的天數，則如果選中，則在到期日後觸發超時處理程式。
* **小時：** 要完成任務的小時數。將任務分配給用戶後計算的小時數。 如果任務未完成，且越過「小時」欄位中指定的小時數，則如果選中，則在到期小時後觸發超時處理程式。
* **到期日後逾時：** 選取此選項以啟用「逾時處理常式」選取欄位。
* **逾時處理常式：** 選取當指派任務步驟超過到期日時要執行的指令碼。放置在[apps]/fd/dashboard/scripts/timeoutHandler之CRX-repository中的指令碼可供選取。 crx-repository中不存在指定的路徑。 管理員在使用路徑之前會建立路徑。
* **在「任務詳細資訊」中突出顯示最後一個任務中的操作和注釋：** 選擇此選項以顯示在任務的「任務詳細資訊」部分上執行的最後一個操作和收到的注釋。
* **類型：** 選擇要在啟動工作流時填寫的文檔類型。您可以選擇最適化表單、唯讀最適化表單、非互動式PDF檔案、互動式通訊代理UI或互動式通訊Web通道檔案。
* **使用最適化表單：** 指定找出輸入最適化表單的方法。如果您從「類型」下拉式清單中選取「適用性表單」或「唯讀適用性表單」，即可使用此選項。 您可以使用提交至工作流程的最適化表單、絕對路徑可用，或變數中的路徑可用。 您可以使用字串類型的變數來指定路徑。\
   您可以將多個最適化表單與工作流程建立關聯。 因此，您可以使用可用的輸入方法，在執行階段上指定最適化表單。

* **使用互動式通訊：** 指定定位輸入互動式通訊的方法。您可以使用提交至工作流程的互動式通訊、絕對路徑可用，或變數中的路徑可用。 您可以使用字串類型的變數來指定路徑。 如果從「類型」下拉清單中選擇「互動式通信代理UI」或「互動式通信Web通道文檔」，則此選項可用。

>[!NOTE]
>
>您必須分配cm-agent-users和workflow-users組，才能在AEM收件箱中訪問Interactive Communications Agent UI。

* **最適化表單或互動式通訊路徑**:指定最適化表單或互動式通訊的路徑。您可以使用提交至工作流程的最適化表單或互動式通訊（以絕對路徑提供），或從字串資料類型變數中儲存的路徑擷取最適化表單。
* **使用選擇輸入PDF:** 指定非互動式PDF檔案的路徑。在「類型」欄位中選擇非互動式PDF文檔時，該欄位可用。 您可以使用相對於裝載的路徑、以絕對路徑儲存，或使用文檔資料類型的變數來選擇輸入PDF。 例如， [Payload_Directory]/Workflow/PDF/credit-card.pdf。 crx-repository中不存在路徑。 管理員在使用路徑之前會建立路徑。 若要使用「PDF路徑」選項，您需要啟用「記錄檔」選項或以表單範本為基礎的最適化表單。
* **對於已完成的任務，將最適化表單呈現為**:將任務標籤為完成時，您可以將適用性表單轉譯為唯讀適用性表單或PDF檔案。您需要啟用「記錄檔案」選項或基於表單範本的最適化表單，才能將最適化表單轉譯為「記錄檔案」。
* **預先填入：** 下列欄位可作為任務的輸入：

   * **使用選取輸入資料檔案：** 輸入資料檔案的路徑(.json,.xml、.doc或表單資料模型)。 您可以使用與裝載相關的路徑來擷取輸入資料檔案，或擷取儲存在檔案、XML或JSON資料類型變數中的檔案。 例如，檔案包含透過AEM收件匣應用程式為表單提交的資料。 範例路徑為[Payload_Directory]/workflow/data。
   * **使用選擇輸入附件：** 該位置可用的附件附加到與任務關聯的表單。路徑一律相對於裝載。 範例路徑為[Payload_Directory]/attachments/
   * **選擇輸入JSON:** 使用與裝載相對的路徑，或儲存在檔案、JSON或表單資料模型資料類型的變數中，選取輸入JSON檔案。如果從「類型」下拉清單中選擇「互動式通信代理UI」或「互動式通信Web通道文檔」，則此選項可用。
   * **選擇自訂預填服務：** 選取預填服務以擷取資料，並預填互動式通訊Web通道檔案或代理UI。

   * **使用上述所選互動式通訊的預填服務：** 使用此選項可使用「使用互動式通訊」下拉式清單中定義的互動式通訊的預填服務。
   * **請求屬性對應：** 使用「請求屬性對應」區段來 [定義請求屬性的名稱和值](../../forms/using/work-with-form-data-model.md#bindargument)。根據請求中指定的屬性名稱和值，從資料來源擷取詳細資料。 您可以使用常值或字串資料類型的變數來定義請求屬性值。\
      只有在從「類型」下拉清單中選擇「互動式通信代理」UI或「互動式通信Web通道文檔」時，預填服務和請求屬性映射選項才可用。

* **已提交資訊：** 下列欄位可作為任務的輸出位置：

   * **使用儲存輸出資料檔案：** 儲存資料檔案(.json、。xml、.doc或表單資料模型)。 資料檔案包含透過關聯表單提交的資訊。 您可以使用與裝載相對的路徑儲存輸出資料檔案，或將其儲存在檔案、XML或JSON資料類型的變數中。 例如， [Payload_Directory]/Workflow/data，其中資料為檔案。
   * **使用儲存附件：** 儲存任務中提供的表單附件。您可以使用相對於裝載的路徑保存附件，或將其儲存在Document資料類型陣列的變數中。
   * **使用保存記錄文檔：** 保存記錄文檔檔案的路徑。例如， [Payload_Directory]/DocumentofRecord/credit-card.pdf。 您可以使用與裝載相關的路徑來保存記錄文檔，或將其儲存在文檔資料類型的變數中。 如果選擇&#x200B;**相對於有效負載**&#x200B;選項，則如果路徑欄位為空，則不會生成記錄文檔。 只有在從「類型」下拉式清單中選取「最適化表單」時，才可使用此選項。

   * **使用儲存Web管道資料：** 使用與裝載相對的路徑儲存Web管道資料檔案，或將其儲存在檔案、JSON或表單資料模型資料類型的變數中。只有在從「類型」下拉清單中選擇「互動式通信代理」時，此選項才可用。
   * **使用儲存PDF檔案：** 使用與裝載相對的路徑儲存PDF檔案，或將其儲存在檔案資料類型的變數中。只有在從「類型」下拉清單中選擇「互動式通信代理」時，此選項才可用。
   * **使用儲存配置模板：** 使用與裝載相關的路徑保存配置模板，或將其儲存在文檔資料類型的變數中。[版面範本](../../forms/using/layout-design-details.md)會參照您使用Forms Designer建立的XDP檔案。 只有在從「類型」下拉清單中選擇「互動式通信代理」時，此選項才可用。

* **受託人>指派選項：** 指定將任務指派給使用者的方法。您可以使用參與者選擇器指令碼將任務動態分配給用戶或組，或將任務分配給特定AEM用戶或組。
* **參與者選擇器：** 當在「分配選項」欄位中選 **擇「動態地對用** 戶或組」時，該選項可用。您可以使用ECMAScript或服務來動態選取使用者或群組。 如需詳細資訊，請參閱[將工作流動態分配給用戶](https://helpx.adobe.com/experience-manager/kb/HowToAssignAWorkflowDynamicallyToParticipants.html)和[建立自定義Adobe Experience Manager動態參與者步驟。](https://helpx.adobe.com/experience-manager/using/dynamic-steps.html)

* **參與者：** 在「參與者選擇」欄 **[!UICONTROL 位中選取com.adobe.granite.workflow.core.process.]** RandomParticipantChooseroption時，此欄位可 **** 用。欄位允許您為RandomParticipantChooser選項選擇用戶或組。

* **受託人：** 在參與者選擇欄位中選 **[!UICONTROL 取com.adobe.fd.workspace.step.service.]** VariableParticipantChooseris時，此欄 **位可** 用。欄位可讓您選取字串資料類型的變數，以定義受託人。

* **參數：** 在「參與者選擇器」欄位中選擇了RandomParticipantChoose指令碼以外的指令碼時，該欄位可用。欄位允許您為在「參與者選擇器」欄位中選擇的指令碼提供逗號分隔參數的清單。

* **用戶或組：** 將任務分配給選定的用戶或組。在&#x200B;**Assign options**&#x200B;欄位中選取&#x200B;**對特定使用者或群組選項**&#x200B;時，此選項可用。 欄位會列出工作流程使用者群組的所有使用者和群組。\
   **使用者或群組**&#x200B;下拉式功能表會列出登入使用者可存取的使用者和群組。 使用者名稱的顯示取決於您是否對該特定使用者crx-repository中的&#x200B;**users**&#x200B;節點擁有存取權限。

* **[!UICONTROL 傳送通知電子郵件]**:選取此選項，將電子郵件通知傳送給受託人。將任務分配給用戶或組時，將發送這些通知。 您可以使用&#x200B;**[!UICONTROL 收件者電子郵件地址]**&#x200B;選項指定擷取電子郵件地址的機制。

* **[!UICONTROL 收件者電子郵件地址]**:您可以將電子郵件地址儲存在變數中，使用常值來指定永久電子郵件地址，或使用受託人設定檔中指定之受託人的預設電子郵件地址。您可以使用常值或變數來指定群組的電子郵件地址。 變數選項有助於動態擷取和使用電子郵件地址。 **[!UICONTROL 使用受託人的預設電子郵件地址]**&#x200B;選項僅適用於單一受託人。 在這種情況下，會使用儲存在受分配的用戶配置檔案中的電子郵件地址。

* **HTML電子郵件範本**:為通知電子郵件選取電子郵件範本。若要編輯範本，請修改crx-repository中位於/libs/fd/dashboard/templates/email/htmlEmailTemplate.txt的檔案。
* **允許委派至：** AEM收件匣提供選項給登入的使用者，可將指派的工作流程委派給其他使用者。您可以委派至相同群組內，或委派給其他群組的工作流程使用者。 如果將任務分配給單個用戶，並且選擇了允許委派給受託人組成員&#x200B;**選項，則無法將該任務委派給另一個用戶或組。**
* **共用設定：** AEM收件匣提供選項，可與其他使用者共用收件匣中的單一或所有工作：
   * 選擇&#x200B;**允許受託人在收件箱**&#x200B;中顯式共用選項時，用戶可以按一下該任務並與其他AEM用戶共用。
   * 選擇&#x200B;**允許受託人通過收件箱共用**&#x200B;選項並且用戶共用其收件箱項目或允許其他用戶訪問其收件箱項目時，只有啟用上述選項的任務才與其他用戶共用。

* **動作>預設動作：** 立即可用、提交、儲存和重設動作。預設會啟用所有預設動作。
* **路由變數：** 路由變數的名稱。路由變數會擷取使用者在AEM收件匣中選取的自訂動作。
* **路由：** 任務可以分支到不同的路由。在AEM收件匣中選取時，路由會傳回值，而工作流程會根據選取的路由分支。 可以將路由儲存在String資料類型陣列的變數中，或選擇&#x200B;**Literal**&#x200B;手動添加路由。

* **標題**:指定路由的標題。它會顯示在AEM收件匣中。
* **珊瑚圖示**:指定珊瑚圖示的HTML屬性。AdobeCorelUI程式庫提供大量的觸控優先圖示。 您可以選擇並使用路由的表徵圖。 它會與標題一起顯示在AEM收件匣中。 如果將路由儲存在變數中，則路由會使用預設的「標籤」珊瑚圖示。
* **允許受託人添加註釋**:選擇此選項可為任務啟用注釋。受託人可以在提交任務時從AEM收件匣中新增註解。
* **在變數中儲存註解：** 將註解儲存在字串資料類型的變數中。只有在您選取&#x200B;**允許受託人新增備注**&#x200B;核取方塊時，才會顯示此選項。

* **允許受託人向任務添加附件**:選擇此選項可啟用任務的附件。受託人可以在提交任務時從AEM收件匣中新增附件。
* **使用**&#x200B;儲存輸出任務附件：指定附件資料夾的位置。您可以使用相對於裝載的路徑或文檔資料類型的陣列變數來保存輸出任務附件。 僅當從&#x200B;**********頁簽的**&#x200B;下拉清單中選擇&#x200B;****、**只讀適用性表單**&#x200B;或&#x200B;**非互動式PDF文檔**&#x200B;時，才顯示此選項。

>[!NOTE]
>
>在運行時使用代理UI中的「附件」頁簽，將附件與互動式通信關聯。 在「完成」狀態中開啟工作項後，關聯的附件在sidekick中顯示為任務附件。

* **使用自訂中繼資料：** 選取此選項以啟用自訂中繼資料欄位。自訂中繼資料用於電子郵件範本。
* **自訂中繼資料：** 為電子郵件範本選取自訂中繼資料。自訂中繼資料可在crx-repository中取得，位於apps/fd/dashboard/scripts/metadataScripts。 crx-repository中不存在指定的路徑。 管理員在使用路徑之前會建立路徑。 您也可以對自訂中繼資料使用服務。 您也可以擴充WorkitemUserMetadataService介面，以提供自訂中繼資料。
* **顯示先前步驟的資料**:選擇此選項可使受分配者查看以前的受分配者、已對任務採取的操作、添加到任務的注釋以及已完成任務的記錄文檔（如果可用）。
* **顯示後續步驟中的資料：** 選擇此選項可讓當前受託人查看後續受託人執行的操作和添加到任務的注釋。它還允許當前受託人查看已完成任務的記錄檔案（如果有）。
* **資料類型的可見性：** 預設情況下，受託人可以查看記錄文檔、受託人、所採取的操作以及先前和後續受託人添加的注釋。使用資料類型的可見性選項來限制受分配者可見的資料類型。

## 傳送電子郵件步驟 {#send-email-step}

使用電子郵件步驟來傳送電子郵件，例如，包含記錄檔案、最適化表單連結、互動式通訊連結或附加PDF檔案的電子郵件。 「傳送電子郵件」步驟支援[HTML電子郵件](https://en.wikipedia.org/wiki/HTML_email)。 HTML電子郵件具有回應性，並可適應收件者的電子郵件用戶端和螢幕大小。 您可以使用HTML電子郵件範本來定義電子郵件的外觀、色彩配置和行為。

電子郵件步驟使用Day CQ Mail Service來傳送電子郵件。 使用電子郵件步驟之前，請確定已設定[電子郵件服務](../../forms/using/aem-forms-workflow.md)。 電子郵件步驟具有下列屬性：

**標題：** 步驟的標題有助於識別工作流程編輯器中的步驟。

**說明：** 當您在共用開發環境中工作時，說明對其他程式開發人員很實用。

**電子郵件主旨：** 主旨可從工作流程中繼資料擷取、手動指定，或從儲存在變數中的值擷取。從下列選項中選取：

* **常值 —** 手動指定主旨。
* **從工作流元資料中** 擷取 — 從中繼資料屬性擷取主旨。
* **變數**  — 從字串資料類型變數中儲存的值擷取主旨。

**HTML電子郵件範本**:電子郵件的HTML範本。您可以在電子郵件範本中指定變數。 電子郵件步驟會擷取並顯示輸入項目範本中包含的所有變數。

**電子郵件範本中繼資料：** 電子郵件範本變數的值可以是使用者指定的值、作者或發佈伺服器上資產的路徑、影像，或工作流程中繼資料屬性。

* **常值：** 當您知道要指定的確切值時，可使用選項。例如， [example@example.com](mailto:example@example.com)。

* **工作流程中繼資料：** 將要使用的值儲存至工作流程中繼資料屬性時，請使用選項。選取選項後，在「工作流元資料」選項下方的空白文字方塊中輸入中繼資料屬性名稱。 例如， emailAddress。
* **資產URL:** 使用選項將互動式通訊的網頁連結內嵌至電子郵件。選取選項後，瀏覽並選擇要內嵌的互動式通訊。 資產可位於作者或發佈伺服器上。
* **影像：** 使用選項將影像嵌入電子郵件。選取選項後，瀏覽並選擇影像。 影像選項僅適用於電子郵件範本中可用的影像標籤(&lt;img src=&quot;*&quot;/>)。

**寄件者/收件者的電子郵件地址：** 選取「文字」 **** 選項，以手動指定電子郵件地址，或選取「從工作流程擷 **取」中繼資料** 選項，以從中繼資料屬性擷取電子郵件地址。您也可以為&#x200B;**「從工作流元資料檢索」選項指定元資料屬性陣列清單。**&#x200B;選擇&#x200B;**Variable**&#x200B;選項，從字串資料類型變數中儲存的值檢索電子郵件地址。

**檔案附件：** 指定位置可用的資產會附加至電子郵件。資產的路徑可以是相對於裝載或絕對路徑。 範例路徑為[Payload_Directory]/attachments/。

選擇&#x200B;**Variable**&#x200B;選項，以檢索儲存在Document、XML或JSON資料類型變數中的檔案附件。

**檔案名稱：** 電子郵件附件檔案的名稱。「電子郵件步驟」將附件的原始檔案名更改為指定的檔案名。 可以手動指定名稱，或從工作流程中繼資料屬性或變數中擷取名稱。 當您知道要指定的確切值時，請使用&#x200B;**常值**&#x200B;選項。 使用&#x200B;**Variable**&#x200B;選項，從字串資料類型變數中儲存的值檢索檔案名。 當要使用的值儲存在工作流元資料屬性中時，請使用&#x200B;**從工作流元資料檢索**&#x200B;選項。

## 生成記錄文檔步驟 {#generate-document-of-record-step}

填寫或提交表單時，您可以以打印或文檔格式保存表單記錄。 這稱為記錄檔(DoR)。 您可以使用「產生記錄檔」步驟，建立唯讀或互動式最適化表單的PDF版本。 PDF版本包含填入表單的資訊，以及最適化表單的版面。

「記錄文檔」步驟具有以下屬性：

**使用最適化表單**:指定用於定位輸入自適應表單的方法。您可以使用提交至工作流程的最適化表單、絕對路徑可用，或變數中的路徑可用。 您可以使用字串資料類型的變數，在&#x200B;**選取變數以解析**&#x200B;欄位中指定路徑。\
您可以將多個最適化表單與工作流程建立關聯。 因此，您可以使用可用的輸入方法，在執行階段上指定最適化表單。

**最適化表單路徑**:指定最適化表單的路徑。從&#x200B;**使用最適化表單**&#x200B;欄位中選取&#x200B;**可在絕對路徑**&#x200B;選項時，此欄位可用。

**使用選取輸入資料：** 最適化表單的輸入資料路徑。您可以將資料保留在與裝載相對的位置，指定資料的絕對路徑，或擷取儲存在檔案、JSON或XML資料類型變數中的資料。 輸入資料與最適化表單合併，以建立記錄檔案。

**使用選擇輸入附件路徑：** 附件的路徑。這些附件包含在記錄文檔中。 您可以將附件保留在相對於裝載的位置，指定附件的絕對路徑，或檢索儲存在Document資料類型陣列變數中的附件。

如果指定資料夾的路徑（例如附件），則資料夾中直接可用的所有檔案都將附加到記錄文檔。 如果在指定附件路徑中直接可用的資料夾中有任何檔案可用，則檔案將作為附件包含在記錄文檔中。 如果直接可用的資料夾中有任何資料夾，則會跳過這些資料夾。

**使用以下選項保存生成的記錄文檔：** 指定保留記錄檔案的文檔的位置。您可以選擇覆寫裝載資料夾、將記錄檔案放置在裝載目錄內的位置，或將記錄檔案儲存在Document資料類型的變數中。

**地區**:指定記錄檔案的語言。選擇&#x200B;**常值**&#x200B;從下拉清單中選擇區域設定，或選擇&#x200B;**變數**&#x200B;從字串資料類型變數中儲存的值檢索區域設定。 在變數中儲存地區設定值時，必須定義地區設定代碼。 例如，請為英文指定&#x200B;**en_US**，為法文指定&#x200B;**fr_FR**。

## 調用表單資料模型服務步驟 {#invoke-form-data-model-service-step}

您可以使用[AEM Forms Data Integration](../../forms/using/data-integration.md)來設定和連線到不同的資料來源。 這些資料源可以是資料庫、Web服務、REST服務、OData服務和CRM解決方案。 AEM Forms資料整合可讓您建立包含各種服務的表單資料模型，以對已設定的資料庫執行資料擷取、新增和更新作業。 您可以使用&#x200B;**調用資料模型服務步驟**&#x200B;來選擇表單資料模型(FDM)，並使用FDM的服務來檢索、更新或將資料添加到不同的資料源。

為了說明步驟欄位的輸入，以下資料庫表格和JSON檔案為範例：

**CustomerDetails表示例**

<table>
 <tbody> 
  <tr> 
   <td>屬性</td> 
   <td>值<br /> </td> 
  </tr> 
  <tr> 
   <td>名字<br /> </td> 
   <td>Sarah<br /> </td> 
  </tr> 
  <tr> 
   <td>姓氏</td> 
   <td>玫瑰</td> 
  </tr> 
  <tr> 
   <td>客戶ID</td> 
   <td>1</td> 
  </tr> 
  <tr> 
   <td>電子郵件地址<br /> </td> 
   <td>srose@we.info</td> 
  </tr> 
 </tbody> 
</table>

**範例JSON檔案**

```json
  { 
    customer: { 
     firstName: "Sarah", 
     lastName:"Rose", 
     customerId: "1", 
     emailAddress:"srose@we.info" 
   }, 
    insurance: {
     customerId: "1", 
    policyType: "Premium,
    policyNumber: "Premium-521499",
    customerDetails: { 
     firstName: "Sarah",
     lastName: "Rose",
     customerId: "1",
     emailAddress: "srose@we.info" 
    }
   }
  }
```

「調用表單資料模型服務」步驟具有下列欄位，以便執行表單資料模型操作：

* **標題：** 步驟的標題。它有助於識別工作流程編輯器中的步驟。
* **說明：** 說明適用於在共用開發環境中工作時的其他程式開發人員。

* **表單資料模型路徑**:瀏覽並選取伺服器上存在的表單資料模型。

* **服務**:所選表單資料模型提供的服務清單。
* **服務輸入>使用文字、變數或工作流程中繼資料和JSON檔案提供輸入資料**:服務可以有多個引數。選取選項，以從工作流程中繼資料屬性、JSON物件、變數或直接在提供的文字方塊中輸入值來取得服務引數的值：

   * **常值：** 當您知道要指定的確切值時，可使用選項。例如， srose@we.info。
   * **變數：** 使用選項來擷取儲存在變數中的值。
   * **從工作流元資料擷取：** 當要使用的值儲存在工作流程中繼資料屬性中時，請使用選項。例如， emailAddress。
   * **[!UICONTROL 相對於裝載]**:使用選項可檢索儲存在相對於有效負載的路徑上的檔案附件。選擇選項並指定包含檔案附件的資料夾名稱，或在文本框中指定檔案附件名稱。

      例如，如果CRX儲存庫中的「相對於裝載」資料夾在`attachment\attachment-folder`位置包含檔案附件，請在選取&#x200B;**[!UICONTROL 「相對於裝載]**」選項後，在文字方塊中指定`attachment\attachment-folder`。
   * **JSON點記號：** 當要使用的值位於JSON檔案中時，請使用選項。例如， insurance.customerDetails.emailAddress。 只有選取輸入JSON選項的「對應」輸入欄位時，「JSON點記號」選項才可用。
   * **從輸入JSON對應輸入欄位：** 指定JSON檔案的路徑，以從JSON檔案取得某些服務引數的輸入值。JSON檔案的路徑可以是相對於裝載、絕對路徑，或者您可以使用JSON或表單資料模型類型的變數來選取輸入JSON檔案。

* **服務輸入>使用變數或JSON檔案提供輸入資料：** 選取選項，即可從儲存在絕對路徑、相對於裝載的路徑或變數中的JSON檔案取得所有引數的值。
* **使用**&#x200B;選取輸入JSON檔案：包含所有服務引數值的JSON檔案。JSON檔案的路徑可以是相對於裝載&#x200B;**的**&#x200B;或&#x200B;**絕對路徑。** 您也可以使用JSON或表單資料模型資料類型的變數來擷取輸入JSON檔案。

* **JSON點記號：** 將欄位留空，以使用指定JSON檔案的所有物件作為服務引數的輸入。若要從指定的JSON檔案讀取特定JSON物件，作為服務引數的輸入，請為JSON物件指定點記號，例如，如果您的JSON類似於區段開頭列出的JSON，請指定insurance.customerDetails ，以提供客戶的所有詳細資料作為服務的輸入。
* **服務輸出>對應並將輸出值寫入變數或中繼資料：** 選取選項，將輸出值儲存為crx-repository中工作流程執行個體中繼資料節點的屬性。指定元資料屬性的名稱，並選擇要與元資料屬性映射的相應服務輸出屬性，例如，將輸出服務返回的phone_number與工作流元資料的phone_number屬性映射。 同樣，可以將輸出儲存在「長」資料類型的變數中。當為&#x200B;**[!UICONTROL 要映射的服務輸出屬性選擇屬性]**&#x200B;選項時，只有能夠儲存所選屬性資料的變數才會填充&#x200B;**[!UICONTROL 將輸出保存到]**&#x200B;選項。

* **服務輸出>儲存輸出至變數或JSON檔案：** 選取選項，將輸出值儲存在JSON檔案的絕對路徑、相對於裝載的路徑或變數中。
* **使用下列選項儲存輸出JSON檔案：** 儲存輸出JSON檔案。輸出JSON檔案的路徑可以是相對於裝載或絕對路徑。 您也可以使用JSON或表單資料模型資料類型的變數來儲存輸出JSON檔案。

## 簽署檔案步驟 {#sign-document-step}

「簽署檔案」步驟可讓您使用Adobe Sign來簽署檔案。 「簽署文檔」步驟具有以下屬性：

* **協定名稱：** 指定協定的標題。合約名稱會成為傳送給簽署者之電子郵件的主旨與內文的一部分。 您可以將名稱儲存在字串資料類型的變數中，或選取&#x200B;**Literal**&#x200B;以手動新增名稱。

* **地區：** 指定電子郵件和驗證選項的語言。可以將區域設定儲存在字串資料類型的變數中，或選擇&#x200B;**常值**&#x200B;從可用選項清單中選擇區域設定。 在變數中儲存地區設定值時，必須定義地區設定代碼。 例如，請為英文指定&#x200B;**en_US**，為法文指定&#x200B;**fr_FR**。

* **Adobe Sign雲端設定**:選擇Adobe Sign雲端設定。如果您尚未針對AEM Forms設定Adobe Sign，請參閱[將Adobe Sign與AEM Forms整合](../../forms/using/adobe-sign-integration-adaptive-forms.md)。

* **選擇要使用簽名的文檔：** 您可以從相對於有效負載的位置選擇文檔、使用有效負載作為文檔、指定文檔的絕對路徑，或檢索儲存在「文檔」資料類型變數中的文檔。
* **截止日期：** 在「截止日期」欄位中指定的天數內，任務上沒有任何活動，因此將文檔標籤為截止日期(超過 **截止** 日期)。將記錄的內容指派給使用者進行簽署後，會計算的天數。
* **提醒電子郵件頻率：** 您可以每日或每週間隔傳送提醒電子郵件。該周從將記錄的資料指派給使用者進行簽署之日算起。
* **簽名過程：** 您可以選擇按順序或並行順序對文檔進行簽名。按順序，一個簽名者一次接收文檔以進行簽名。 第一個簽名者完成對文檔的簽名後，將文檔發送給第二個簽名者，以此類推。 同時，多個簽署者一次可以簽署檔案。
* **重新導向URL:** 指定重新導向URL。簽署檔案後，您可以將受託人重新導向至URL。 此URL通常包含感謝訊息或進一步指示。
* **工作流程階段：** 工作流程可以有多個階段。這些階段會顯示在AEM收件匣中。 您可以在模型的屬性中定義這些階段（Sidekick >頁面>頁面屬性>階段）。
* **選擇簽署者：** 指定為文檔選擇簽名者的方法。您可以動態地將工作流程指派給使用者或群組，或手動新增簽署者的詳細資訊。
* **選擇簽署者的指令碼或服務：** 只有在在選擇簽署者欄位中選取了動態選項時，選項才可用。您可以指定ECMAScript或服務來為文檔選擇簽名器和驗證選項。
* **簽署者詳細資訊：** 只有在在「選取簽署者」欄位中選取「手動」選項時，才可使用選項。指定電子郵件地址並選擇可選的驗證機制。 在選取兩步驟驗證機制之前，請確定已設定Adobe Sign帳戶已啟用對應的驗證選項。 您可以使用字串資料類型的變數來定義&#x200B;**[!UICONTROL Email]**、**[!UICONTROL 國家代碼]**&#x200B;和&#x200B;**[!UICONTROL 電話號碼]**&#x200B;欄位的值。 只有在從&#x200B;**[!UICONTROL 2步驗證]**&#x200B;下拉清單中選擇&#x200B;**[!UICONTROL 電話驗證]**&#x200B;時，才會顯示&#x200B;**[!UICONTROL 國家代碼]**&#x200B;和&#x200B;**[!UICONTROL 電話號碼]**&#x200B;欄位。
* **狀態變數：** 啟用Adobe Sign的檔案會將檔案的簽署狀態儲存在字串資料類型的變數中。指定狀態變數的名稱(adobeSignStatus)。 在CRXDE中，例項的狀態變數可在/etc/workflow/instances/&lt;server>/&lt;date-time>/&lt;instance of workflow model>/workItems/&lt;node>/metaData包含變數的狀態。
* **使用以下選項保存已簽名文檔：** 指定保留已簽名文檔的位置。您可以選擇覆蓋裝載檔案、將已簽名文檔放置在裝載目錄中的某個位置，或將已簽名文檔儲存在文檔類型的變數中。

## 文檔服務步驟 {#document-services-steps}

AEM檔案服務是一組用於建立、組裝和保護PDF檔案的服務。 AEM Forms為每個檔案服務提供個別的AEM工作流程步驟。

與其他AEM Forms工作流程步驟（例如「指派任務」、「傳送電子郵件」和「簽署檔案」）類似，您可以在所有AEM檔案服務步驟中使用變數。 如需建立和管理變數的詳細資訊，請參閱AEM工作流程中的[變數](../../forms/using/variable-in-aem-workflows.md)。

### 應用文檔時間戳步驟 {#apply-document-time-stamp-step}

向文檔添加時間戳。 提供文檔詳細資訊，如輸入文檔路徑、輸入文檔名稱、儲存導出資料的位置。 您可以選擇覆蓋現有的有效負載檔案、選擇不同的檔案名以將資料儲存在有效負載資料夾下的不同檔案中、提供資料的絕對路徑，或將資料儲存在文檔資料類型的變數中。

### 轉換為影像步驟 {#convert-to-image-step}

將PDF文檔轉換為影像清單。 支援的影像格式為JPEG、JPEG2000、PNG和TIFF。 下列資訊適用於TIFF影像的轉換：

* 會產生多頁TIFF檔案。
* TIFF影像中不包含某些注釋。 不包含需要Acrobat產生外觀的註解。

### 轉換為PDF/A步驟 {#convert-to-pdf-a-step}

使用提供的選項將PDF文檔轉換為PDF/A格式。 PDF/A版的可攜式檔案格式(PDF)專門用於檔案封存和長期保存。

### 轉換為PS步驟 {#convert-to-ps-step}

將PDF檔案轉換為PostScript。 轉換為PostScript時，可以使用轉換操作指定源文檔以及轉換為PostScript級別2或3。 轉換為PostScript檔案的PDF文檔必須是非互動式的。

### 從指定的類型步驟建立PDF {#create-pdf-from-specified-type-step}

從輸入檔案生成PDF文檔。 輸入文檔可以是相對於有效負載、具有絕對路徑、可以是有效負載本身或儲存在文檔資料類型的變數中。

### 從URL/HTML/ZIP步驟建立PDF {#create-pdf-from-url-html-zip-step}

從提供的URL、HTML和ZIP檔案生成PDF文檔。

### 匯出資料步驟 {#export-data-step}

從PDF forms或XDP檔案匯出資料。 它要求您輸入輸入文檔和導出資料格式的檔案路徑。 「匯出資料格式」的選項有「自動」、「XDP」和「XmlData」。

### Export PDF到指定類型步驟 {#export-pdf-to-specified-type-step}

將PDF文檔轉換為選定格式。

### 產生非互動式PDF步驟 {#generatenoninteractive}

產生非互動式PDF。 它提供各種自訂選項。

>[!NOTE]
>
>可以使用變數指定輸入文檔的模板檔案。 將範本檔案的路徑儲存在字串資料類型的變數中。

### 匯入資料步驟 {#import-data-step}

將表單資料合併為PDF表單。 您可以將表單資料匯入PDF表單。

### 調用DDX步驟 {#invokeddx}

對指定的輸入文檔映射執行DDX檔案並返回操作的PDF文檔。

>[!NOTE]
>
>您可以使用變數來指定輸入文檔的DDX檔案。 將DDX檔案儲存在Document或XML資料類型的變數中。

### Optimize PDF步驟 {#optimize-pdf-step}

縮小PDF檔案的大小，以最佳化PDF檔案。 此轉換的結果為PDF檔案，可能小於其原始版本。 此操作還將PDF文檔轉換為優化參數中指定的PDF版本。

最佳化設定會指定檔案的最佳化方式。 以下是範例設定：

* Target PDF版本
* 丟棄對象，如JavaScript操作和嵌入的頁面縮圖
* 丟棄用戶資料，如注釋和檔案附件
* 丟棄無效或未使用的設定
* 壓縮未壓縮資料或使用更有效的壓縮演算法
* 移除內嵌字型
* 設定透明度值

### 轉譯PDF表單步驟 {#renderpdf}

將在表單設計器(XDP)中建立的表單轉譯為PDF表單。

>[!NOTE]
>
>可以使用變數指定輸入文檔的模板檔案。 將範本檔案的路徑儲存在字串資料類型的變數中。

### 安全文檔步驟 {#secure-document-step}

加密、簽署和認證檔案。 AEM Forms支援密碼和憑證基底加密。 您也可以選擇各種檔案簽署演算法。 例如SHA-256和SH-512。 您也可以使用工作流程步驟來讀取擴充PDF檔案。 工作流程步驟提供可啟用條碼解碼、數位簽名、匯入和匯出PDF資料的選項，以及其他選項。

### 發送到打印機步驟 {#send-to-printer-step}

將文檔直接發送到打印機。 它支援下列打印訪問機制：

* **可直接訪問的打印機**:安裝在同一台電腦上的打印機稱為直接可訪問的打印機，該電腦名為打印機主機。此類打印機可以是直接連接到電腦的本地打印機。
* **間接可訪問打印機**:安裝在打印伺服器上的打印機可從其他電腦訪問。通用UNIX®打印系統(CUPS)和線型打印機守護程式(LPD)協定等技術可用於連接到網路打印機。 要訪問間接可訪問的打印機，請指定打印伺服器的IP或主機名。 使用此機制，當網路運行LPD時，可以將文檔發送到LPD URI。 該機制允許您將文檔路由到連接到運行LPD的網路的任何打印機。

### 生成打印輸出步驟 {#generatePrintedOutput}

該步驟將生成PCL、PostScript、ZPL、IPL、TPCL或DPL輸出，並提供表單設計和資料檔案。 資料檔案與表單設計合併，並格式化以便打印。 通過此步驟生成的輸出可以直接發送到打印機或另存為檔案。 當您想要使用來自應用程式的表單設計或資料時，建議您使用此步驟。 如果您的表單設計或表單設計位於網路、本地檔案系統或HTTP位置，請使用generatePrintedOutput操作操作。

例如，您的應用程式要求您將表單設計與資料檔案合併。 資料包含數百筆記錄。 此外，它要求將輸出發送到支援ZPL的打印機。 表單設計和輸入資料位於應用程式中。 使用generatePrintedOutput操作將每個記錄與表單設計合併，並將輸出發送到支援ZPL的打印機。

「生成打印輸出」步驟具有以下屬性：

**輸入屬性**

* **[!UICONTROL 使用]**&#x200B;選取範本檔案：指定範本檔案的路徑。您可以使用相對於裝載的路徑、以絕對路徑保存的路徑或使用文檔資料類型的變數來選擇模板檔案。 例如， [Payload_Directory]/Workflow/data.xml。 如果crx-repository中不存在路徑，管理員可以先建立路徑再使用。 此外，您也可以接受裝載作為輸入資料檔案。

* **[!UICONTROL 使用]**&#x200B;選取資料檔案：指定輸入資料檔案的路徑。您可以使用相對於有效負載的路徑、保存在絕對路徑上的路徑，或使用文檔資料類型的變數來選擇輸入資料檔案。 例如， [Payload_Directory]/Workflow/data.xml。 如果crx-repository中不存在路徑，管理員可以先建立路徑再使用。

* **[!UICONTROL 打印機格式]**:「打印格式」值，指定在未提供XDC檔案時用於生成輸出流的頁面描述語言。如果您提供常值，請選取以下其中一個值：

   * **[!UICONTROL 自定義PCL]**:使用選項為PCL指定自定義XDC檔案。
   * **[!UICONTROL 自訂PostScript]**:使用選項可指定PostScript的自訂XDC檔案。
   * **[!UICONTROL 自定義ZPL]**:使用選項為ZPL指定自定義XDC檔案。
   * **[!UICONTROL 通用顏色PCL(5c)]**:使用通用顏色PCL(5c)。
   * **[!UICONTROL 一般PostScript層級3]**:使用一般PostScript第3層。
   * **[!UICONTROL ZPL 300 DPI]**:使用300 DPI。已使用zpl300.xdc。
   * **[!UICONTROL ZPL 600 DPI]**:使用600 DPI。使用zpl600.xdc檔案。
   * **[!UICONTROL 自定義IPL]**:使用選項為IPL指定自定義XDC檔案。
   * **[!UICONTROL IPL 300 DPI]**:使用IPL 300 DPI。已使用ipl300.xdc。
   * **[!UICONTROL IPL 400 DPI]**:使用IPL 400 DPI。使用ipl400.xdc檔案。
   * **[!UICONTROL 自訂TPCL]**:使用選項為TPCL指定自定義XDC檔案。
   * **[!UICONTROL TPCL 305 DPI]**:使用TPCL 300 DPI。使用tpcl305.xdc檔案。
   * **[!UICONTROL PCL 600 DPI]**:使用TPCL 600 DPI。使用tpcl600.xdc檔案。
   * **[!UICONTROL 自訂DPL]**:使用選項可指定自訂XDC檔案DPL。
   * **[!UICONTROL DPL300DPI]**:使用DPL 300 DPI。使用dpl300.xdc檔案。
   * **[!UICONTROL DPL406DPI]**:使用DPL 400 DPI。已使用dpl406.xdc。
   * **[!UICONTROL DPL600DPI]**:使用DPL 600 DPI。已使用dpl600.xdc。

**輸出屬性**

* **[!UICONTROL 使用]**&#x200B;儲存輸出檔案：指定儲存輸出檔案的位置。您可以將輸出檔案儲存在與裝載相對的位置、變數中，或指定儲存輸出檔案的絕對位置。 如果crx-repository中不存在路徑，管理員可以先建立路徑再使用。

**進階屬性**

* **[!UICONTROL 使用]**&#x200B;選取「內容根」位置：內容根是字串值，它指定URI、絕對參照或儲存庫中的位置，以檢索表單設計使用的相對資產。例如，如果表單設計相對參照影像，例如../myImage.gif，則myImage.gif必須位於repository://。 預設值為repository:// ，指向儲存庫的根級別。

   當您從應用程式中挑選資產時，內容根URI路徑必須具有正確的結構。 例如，如果從名為SampleApp的應用程式中挑選表單，並放在SampleApp/1.0/forms/Test.xdp ，則內容根URI必須指定為repository://administrator@password/Applications/SampleApp/1.0/forms/ ，或存放庫：/Applications/SampleApp/1.0/forms/（當權限為null時）。 以此方式指定「內容根URI」時，表單中所有參考資產的路徑將會針對此URI進行解析。

* **[!UICONTROL 使用]**&#x200B;選取XCI檔案：XCI檔案用於描述用於表單設計元素的字型和其他屬性。您可以保留相對於裝載、絕對路徑或使用Document資料類型變數的XCI檔案。

* **[!UICONTROL 地區]**:指定用於生成PDF文檔的語言。如果您提供常值，請從清單中選取語言，或選取以下任一值：
   * **要使用伺服器預設值**:（預設）使用AEM Forms伺服器上配置的「地區」設定。使用管理控制台配置了「區域設定」。 （請參閱[Designer幫助](http://www.adobe.com/go/learn_aemforms_designer_65)。）

   * **若要使用自訂值**:在文字框中鍵入地區代碼，或選擇包含地區代碼的字串變數。有關支援的區域設定代碼的完整清單，請參見http://java.sun.com/j2se/1.5.0/docs/guide/intl/locale.doc.html。

* **[!UICONTROL 副本]**:一個整數值，它指定要為輸出生成的副本數。預設值為 1。

* **[!UICONTROL 雙面打印]**:指定是使用雙面打印還是單面打印的分頁值。支援PostScript和PCL的打印機使用此值。如果提供常值，請選擇以下值之一：
   * **[!UICONTROL 雙工長邊]**:使用長邊分頁，進行雙面打印和打印。
   * **[!UICONTROL 雙工短邊]**:使用短邊分頁進行雙面打印和打印。
   * **[!UICONTROL 單純]**:使用單面打印。
