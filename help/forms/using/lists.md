---
title: AEM中的檔案片段
description: 通訊管理中的檔案片段（例如文字、清單、條件和版面配置片段）可讓您形成客戶通訊的靜態、動態且可重複的元件。
topic-tags: correspondence-management
products: SG_EXPERIENCEMANAGER/6.5/FORMS
docset: aem65
feature: Correspondence Management
exl-id: 71754e41-45d7-4cc5-ba49-0748bd51c0cf
source-git-commit: f349c8fd9c370ba589d217cd3b1d0521ae5c5597
workflow-type: tm+mt
source-wordcount: '6905'
ht-degree: 0%

---

# 文件片段{#document-fragments}

## 文件片段 {#document-fragments-1}

檔案片段是可重複使用的通訊零件/元件，您可以使用它們來撰寫信件/通訊。 檔案片段屬於以下型別：

* **文字**：文字資產是由一或多個文欄位落組成的一段內容。 段落可以是靜態或動態的。
* **清單**：清單是一組檔案片段，包括文字、清單、條件和影像。 清單元素的順序可以固定或編輯。 建立信函時，您可以使用部分或全部清單元素來複製可重複使用的元素模式。
* **條件**：條件可讓您根據提供的資料，定義在建立通訊時應包含的內容。 條件會以控制變數的形式說明。 控制變數可以是資料字典元素或預留位置。
* **佈局片段**：佈局片段是可在一或多個字母內使用的佈局。 佈局片段用於建立可重複的模式，尤其是動態表格。 版面配置可包含一般表單欄位，例如「地址」和「參考號碼」。 其中也包含表示目標區域的空白子表單。 版面(XDP)會在Designer中建立，然後上傳至AEM Forms。

## 文字 {#text}

文字資產是由一或多個文欄位落所組成的一段內容。 段落可以是靜態或動態的。 動態段落包含資料元素的參照，其值在執行階段提供。 例如，信件稱呼中的客戶名稱可能是動態資料元素，其值可在執行階段提供。 透過變更這些值，相同的字母範本可用於為不同客戶產生字母。

通訊管理解決方案支援兩種動態資料專案（變數資料）：

* **資料字典元素**：這些元素會繫結至資料字典，並從提供的資料來源取得其值。 資料字典變數可以受保護或不受保護。 在建立通訊期間，使用者可以修改未受保護資料字典變數的預設值，但無法修改受保護字典變數。
* **預留位置**：這些變數未繫結至後端資料來源。 它們要求使用者在建立通訊期間填寫值。 預留位置預設為未受保護。

>[!NOTE]
>
>「通訊管理」範本在建立預留位置時，不會強制您建立唯一的名稱。 如果您建立名稱相同的兩個預留位置（例如文字和條件），並在信函範本中同時使用它們，則兩個預留位置都會使用最後插入的預留位置值。 如果兩個預留位置具有相同的名稱，則會比較其型別。 如果型別不同，則其型別會變成String。 但是，在模組內，您無法建立多個名稱相同的預留位置。

### 建立文字 {#create-text}

1. 選取 **Forms** > **檔案片段**.
1. 選取 **建立** > **文字** 或選取文字資產，然後選取 **編輯**.
1. 指定文字的下列資訊：

   * **標題： （選擇性）** 輸入文字資產的標題。 標題不需要是唯一的，而且可以有特殊字元和非英文字元。 文字是以標題（可用時）來參照，例如在縮圖和資產屬性中。
   * **名稱：** 文字資產的唯一名稱。 任何狀態下都不可有兩個資產（文字、條件或清單）以相同名稱存在。 在「名稱」欄位中，您只能輸入英文字元、數字和連字型大小。 「名稱」欄位會根據「標題」欄位自動填入。 在「標題」欄位中輸入的特殊字元、空格、數字和非英文字元，會由「名稱」欄位中的連字型大小取代。 雖然「標題」欄位中的值會自動複製到「名稱」，但您可以編輯值。
   * **說明**：輸入資產的說明。
   * **資料字典**：選擇性地選取要對應的資料字典。 此屬性可讓您在文字資產中新增資料字典元素的參考。
   * **標籤**：若要建立自訂標籤，請在文字欄位中輸入值，然後按Enter鍵。 您可以在標籤的文字欄位下方看到您的標籤。 儲存此文字時，也會建立新新增的標籤。

1. 選取 **下一個**. 「通訊管理」會顯示「編輯器」頁面，您可以在其中新增文欄位落和資料元素至文字。

   瀏覽器中的預設拼字檢查程式會檢查文字編輯器中的拼字。 若要管理拼字與文法檢查，您可以編輯瀏覽器的拼字檢查程式設定，或安裝瀏覽器外掛程式/附加元件以檢查拼字與文法。

   您也可以在文字編輯器中使用各種鍵盤快速鍵來管理、編輯文字及設定文字格式。 如需詳細資訊，請參閱 [文字編輯器](/help/forms/using/keyboard-shortcuts.md#p-formatting-p) 通訊管理鍵盤快速鍵中的鍵盤快速鍵。

1. 文字編輯器開啟，輸入文字。 使用頁面頂端的工具列來格式化文字、插入條件、連結和分頁符號。

   ![工具列](assets/advancedediting.png)

   * **連結**：插入 [超文字](#insert-hyperlink) 文字中的連結。
   * **重複**：使用分隔符號重複列印資料字典中的收集元素。
   * **條件**：選取以插入條件。 根據條件插入文字。 如果條件為true，則信函中會顯示文字，否則不會顯示。
   * **新增說明**：將註解新增至文字片段。 這是作者可見的中繼資料，但不是所建立信函的一部分。
   * **分頁符號**：如果您將文字模組的分頁符號屬性設為false，則文字模組不會跨頁面分頁。

   文字編輯器隨即開啟。 輸入文字。 工具列會根據您選擇進行的編輯型別而變更：「段落」、「對齊方式」或「清單」：

   ![選取工具列型別](assets/toolbarselection.png)

   選取工具列型別：「段落」、「對齊方式」或「清單」

   ![段落工具列](assets/fonteditingtoolbar.png)

   段落工具列
   [![對齊工具列](assets/paragrapheditingtoolbar.png)](assets/paragrapheditingtoolbar-1.png)對齊工具列

   ![清單工具列](assets/bulleteditingtoolbar.png)

   清單工具列（按一下以開啟全尺寸影像）

1. 若要重複使用存在於其他應用程式(例如從MS Word或HTML頁面)中的文欄位落，請複製該文字並將其貼到文字編輯器中。 複製的文字的格式會保留在文字編輯器中。

   您可以在可編輯文字模組中複製並貼上文字的一或多個段落。 例如，您可能會有MS Word檔案，其中包含可接受的居住證明專案符號清單，如下所示：

   ![pastetextmsword-1](assets/pastetextmsword-1.png)

   您可以直接從MS Word檔案複製文字並貼上至可編輯的文字模組。 專案符號清單、字型和文字顏色等格式會保留在文字模組中。

   ![Pastetexttextmodule](assets/pastetexttextmodule.png)

   >[!NOTE]
   >
   >不過，貼上文字的格式有些 [限制](https://helpx.adobe.com/aem-forms/kb/cm-copy-paste-text-limitations.html).

1. 如有必要，請在檔案片段中插入特殊字元。 例如，您可以使用「特殊字元」浮動視窗來插入：

   * 幣別符號，例如€、¥和£
   * 數學符號，例如∑、√、∂和^
   * 標點符號如&quot;和&quot;

   ![specialcharacters-1](assets/specialcharacters-1.png)

   通訊管理已內建對210個特殊字元的支援。 管理員可以 [透過自訂新增更多/自訂特殊字元的支援](/help/forms/using/custom-special-characters.md).

1. 若要在可編輯的內嵌模組中反白顯示\強調部分文字，請選取文字並選取「反白顯示顏色」。

   ![已套用textbackgroundcolors](assets/textbackgroundcolorapplied.png)

   您可以直接選取基本顏色 `**[A]**` 出現在「基本色彩」調色盤中，或選取 **選取** 使用滑桿之後 `**[B]**` 以選擇適當的顏色著色。

   或者，您也可以移至「進階」標籤，選取適當的「色相」、「明度」和「飽和度」 `**[C]**` 以建立精確顏色，然後選取「選取」 `**[D]**` 以套用顏色來反白顯示文字。

   ![textbackgroundcolor-1](assets/textbackgroundcolor-1.png)

1. 從資料面板，拖放資料字典元素和預留位置元素至文字。

   至：

   * 在文字中新增資料字典元素，從清單中選取資料元素，然後選取「插入」( ![插入](assets/insert.png))。 如果您選取「受保護」，資料字典元素為唯讀，且會出現在信函編輯器中，但不會出現在「建立通訊」使用者介面或「通訊建立者」中。
   * 在文字中新增預留位置元素，在「資料元素」面板中選取「新建」，輸入新資料元素的詳細資訊，然後選取「建立」將新元素新增至清單。 新預留位置可以與資料字典元素一樣插入文字中。 若要編輯預留位置，請選取預留位置，然後選取編輯。

   ![預留位置元素](assets/placeholder_elements_in_xmldata.png)

   資料字典的範例資料檔案中指定的預留位置元素

   ![信函中的預留位置元素](assets/placeholder_elements_in_text.png)

   CCR檢視中的預留位置元素值是從資料字典變數填入，如範例資料檔案中所指定

   您也可以使用@符號來搜尋資料，並將資料字典和預留位置元素新增至文字編輯器。 將游標置於要插入元素的位置。 輸入@，後面接著搜尋字串。 文字編輯器會對文字檔案片段中可用的所有資料字典和預留位置元素執行搜尋操作。 搜尋作業會擷取並將包含搜尋字串的元素顯示為下拉式清單。 瀏覽搜尋結果，然後按一下您要在游標位置插入的元素。 按下Esc鍵以隱藏搜尋結果。

1. 您可以使用內嵌條件和重複來讓您的信函高度與情境相關，並妥善建構。 如需內嵌條件和重複的詳細資訊，請參閱 [內嵌條件和在字母中重複](/help/forms/using/cm-inline-condition.md).
1. 選取「**儲存**」。

#### 在文字中插入超連結 {#insert-hyperlink}

執行以下步驟，在文字資產中建立超連結：

1. 在文字編輯器中選取文字或資料模型物件。

2. 選取 **[!UICONTROL 連結]**. 選取 **[!UICONTROL 替代文字]** 欄位以移除現有的資料模型物件名稱或文字。

3. 指定URL並選取 ![儲存](assets/save_icon.svg).

![在文字資產中建立超連結](assets/text-create-hyperlink.png)

#### 搜尋和取代文字 {#searching-and-replacing-text}

使用包含大量文字的文字元素時，您需要搜尋特定的文字字串。 您可能還需要將特定字串取代為替代字串。

「尋找和取代」功能可讓您搜尋（和取代）文字元素中的任何文字字串。 此功能還包括強大的規則運算式搜尋。

#### 若要搜尋文字模組中的文字 {#to-search-text-in-a-text-module}

1. 在文字編輯器中開啟文字模組。

1. 選取「尋找和取代」。
1. 在「尋找」文字方塊中輸入要搜尋的文字，然後按「尋找」。 搜尋文字會在文字模組中反白顯示。
1. 若要搜尋文字的下一個例項，請再次按尋找。

   如果繼續按「尋找」按鈕，搜尋會沿頁面繼續進行。 找到文字的最後一個例項後，訊息會 **到達模組終點** 表示找不到其他搜尋結果。

   不過，如果在文字模組中找不到搜尋文字的執行個體，則顯示的訊息為： **找不到相符專案**.

1. 如果您再按一次「尋找」，搜尋會在頁面頂端繼續。

#### 搜尋選項 {#search-options}

**大小寫須相符：** 搜尋只會傳回相同大小寫的結果。

**全字：** 搜尋只會傳回全字。

>[!NOTE]
>
>如果您在「尋找」文字方塊中輸入任何特殊字元，則「全字」選項會停用。

**規則運算式：** 使用規則運算式進行搜尋。 例如，下列規則運算式會搜尋文字模組中的電子郵件地址：

`[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}`

#### 搜尋和取代文字模組中的文字 {#to-search-and-replace-text-in-a-text-module}

1. 在文字編輯器中開啟文字模組。
1. 選取「尋找和取代」。
1. 在「尋找」文字方塊中輸入要搜尋的文字，以及要取代尋找文字的文字，然後按「取代」。
1. 如果找到搜尋文字，文字會以「取代」文字取代。

   * 如果找到搜尋文字的另一個例項，該例項會在文字模組中反白顯示。 如果再次按下「取代」，則反白的例證會被取代，而游標會向前移動（如果找到第三個例證）。
   * 如果找不到另一個執行個體，游標會停留在最後一個取代的執行個體。

1. 如果您再按一次「尋找」，搜尋會在頁面頂端繼續。

   使用「全部取代」選項可取代文字模組中文字的所有實體。 當您執行「時，取代的數量會在「尋找和取代」對話方塊中顯示為訊息。

#### 文字模組的最佳作法/提示與秘訣 {#best-practices-tips-and-tricks-for-text-modules}

* 使用一致的命名慣例以避免重複。
* 在文字模組中使用適當的資料字典繫結。
* 變更文字資產時，下列規則適用於使用文字編輯器：

   * **新增變數：** 允許
   * **移除變數：** 允許
   * **屬性更新：** 允許
   * **變更資料字典：** 允許直到未使用資料字典元素為止。 您無法於更新時變更資料字典。

## 清單 {#list}

清單是一組檔案片段，包括文字或（其他）清單、條件和影像。 清單元素的順序可以固定或編輯。 建立信函時，您可以使用部分或全部清單元素來複製可重複使用的元素模式。 清單基本上是作為可以巢狀內嵌於其他目標的目標。

### 實作清單 {#implementing-lists}

實作清單包含兩個步驟：

1. 定義名稱、說明、資料字典等核心屬性。
1. 屬於清單一部分的內容，然後設定清單的鎖定順序和程式庫存取權等屬性。

### 建立清單 {#create-a-list}

清單是一組相關內容，可在信函範本中作為單一單位使用。 任何型別的內容都可以新增到清單中。 清單也可以採用巢狀結構。 清單模組可指定為：

* **已訂購**：在建立通訊執行階段中無法變更順序。
* **程式庫存取權**：使用者可以將模組新增至清單。 此旗標會指定是否啟用程式庫存取。 如果啟用（開啟），使用者可以在預覽信函時將模組新增到清單。
* 建立清單時，您可以指定型別，例如：
* **平坦**：清單不會套用其他樣式格式。
* **專案符號**：以簡單專案符號格式化的清單。
* **編號**：數字清單，可選擇標準(1,2，...)、大羅馬字(I，II， ...)及小羅馬字(i，ii，...)數字。
* **有字母**：字母順序清單，可選擇小寫(a，b，...)和大寫(A，B，...)字母。
* **自訂**：您可以建立任何編號/字母型別，以及您選擇的前置詞與後置詞值。

1. 選取 **Forms** > **檔案片段**.

1. 選取 **建立** > **清單**.

1. 為清單指定下列資訊：

   * **標題（選用）：輸入** 清單的標題。 標題不需要是唯一的，並且可以有特殊字元和非英文字元。 清單會以其標題來參照（如果有的話），例如在縮圖和資產屬性中。
   * **名稱：** 清單的唯一名稱。 任何狀態下都不可有兩個資產（文字、條件或清單）以相同名稱存在。 在「名稱」欄位中，您只能輸入英文字元、數字和連字型大小。 「名稱」欄位會自動填入「標題」欄位中的值。 在「標題」欄位中輸入的特殊字元、空格、數字和非英文字元，會由「名稱」欄位中的連字型大小取代。 雖然「標題」欄位中的值會自動複製到「名稱」，但您可以編輯值。
   * **說明（選擇性）**：輸入資產的說明。
   * **資料字典（選擇性）**：選擇性地選取要連線的資料字典。 只有使用與清單相同資料字典的資產，或沒有指派資料字典的資產，才能新增至清單。 將資料字典指派給清單可讓建立信函範本的人員更輕鬆找到合適的清單。
   * **標籤（選擇性）**：選取要套用的標籤。 您也可以輸入新標簽名稱並建立它。 (當您選取「 」時，會建立新標籤 **儲存**.)

1. 選取&#x200B;**「下一步」**。
1. 選取 **新增資產**.
1. 若要將資產新增至清單，請在「選取資產」頁面中選取資產，然後選取 **完成**.

   ![選取要新增至清單的資產](assets/selectassets.png)

1. 資產會新增至「清單專案」頁面。
若要變更清單中資產的順序，請選取並按住箭頭圖示( ![拖放](assets/dragndrop.png) )和拖放。 當使用者在「建立通訊」使用者介面中開啟信函範本時，內容會依照您在此處定義的順序進行組裝。

   ![重新排序和設定清單中的資產](assets/listitems.png)

1. 您可以選取下列選項來指定清單在CCR使用者介面中的行為：

   * **程式庫存取權**：若要啟用資料庫存取權以新增資產，請選取「資料庫存取權」。 啟用「資料庫存取」時，宣告調整者可以向清單新增更多內容。 否則，「索賠理算師」會受限於您為清單定義的內容。
   * **鎖定順序**：若要鎖定清單中資產的順序，讓宣告調整器無法變更順序，請選取「鎖定順序」。 如果您未選取此選項，「宣告調整器」可以變更清單專案的順序。

   * **新增專案符號**：使用此選項將專案符號或編號樣式套用至模組。 您可以使用預先設計的清單樣式或自訂樣式。 您也可以指定要在每個清單專案之前和之後顯示的文字。
   * **分頁符號**：選取此選項( ![中斷](assets/break.png))，在清單內容之間新增分頁符號。 未選取此選項時( ![nobreak](assets/nobreak.png))，如果清單內容溢位到下一頁，則整個清單會移至下一頁，而不是在清單之間的頁面中中斷。

   * **指派設定**：使用此選項可指定可新增至清單的資產數目下限和上限。

1. 您可以選取下列選項，指定清單中每個資產在執行階段時的行為：

   * **可編輯：** 選取此選項時，可在「建立通訊」使用者介面中編輯內容。 （「清單」和「影像」模組不提供此選項。）
   * **強制：** 選取此選項時，內容需在「建立通訊」使用者介面中。
   * **已選取：** 選取此選項時，會在「建立通訊」使用者介面中預先選取內容。
   * **略過樣式：** 選取此選項時，內容會略過「建立對應」使用者介面中的專案符號和編號。 (此選項不適用於影像模組。 此外，在「略過樣式」、「複合」和「忽略清單樣式」之間，只有一個選項可套用至模組。 當您為模組選取新增專案符號時，這些選項之一可用於模組。)
   * **縮排：** 您可以變更作為「清單」一部分的每個選取模組/內容的縮排層級。 縮排是以「層級」（從零開始）來指定，因此每個層級的縮排都對應於36點的內距。
   * **複合：** 選取後，組合編號會套用為外部（父項）清單的樣式及其自身樣式的組合。 此巢狀「清單」上的複合編號是根據此巢狀「清單」出現在外部「清單」中的順序而定。
   * **忽略清單樣式：** 如果取消選取「組合編號」選項，則會啟用「忽略清單樣式」選項。 此選取範圍會忽略巢狀「清單」自己的樣式，而編號會從外部「清單」繼續。 因此，巢狀清單的模組會被視為外部清單本身的一部分，而不考慮巢狀清單中指定的任何樣式。 如果取消選取巢狀「清單」的「忽略清單樣式」選項，屬於該巢狀「清單」一部分的模組會有自己的編號樣式。
   * **與下一個保持一致：** 為清單中包含的資產設定分頁符號。 如果您將清單中一個資產的「與下一個相同」屬性設為 **開啟**，則該資產和下一個資產會停留在相同頁面。 這表示選取的資產與下一個資產的內容不會跨頁面中斷。

1. 選取「**儲存**」。

### 最佳實務/提示與秘訣 {#best-practices-tips-and-tricks}

* 使用一致的命名慣例以避免重複。
* 使用適當的資料字典繫結
* 使用清單編輯器變更清單時，適用下列規則：

   * 屬性更新：允許
   * **變更資料字典：** 允許直到沒有使用資料字典的專案與其相關聯為止。 您無法於更新時變更資料字典。

## 條件 {#conditions}

條件可讓您根據提供的資料，定義建立通訊/信函時要包含的內容。 條件會以控制變數的形式說明。 新增條件時，您可以選擇根據控制變數的值納入資產。

根據您選擇的選項，只會根據目前的條件變數評估第一個被發現為true的運算式，或評估所有條件。 在「建立通訊」(CCR)中填寫信函時，條件行為類似於「白框」。 如果條件產生清單，則會輸出清單中的所有必要和預先選取的專案。 如果這些專案中有任何專案是條件或清單本身，則其產生的內容也會以自上而下、從深度到第一的順序輸出，作為文字和影像內容的平面清單。 條件結果可以是任何型別（文字、清單、條件或影像）。

### 實作條件 {#implementing-conditions}

條件編輯器隨附 [運算式產生器](/help/forms/using/expression-builder.md) 使用者介面，可支援使用多個預留位置與資料字典元素來建立運算式。 您可以在這類運算式中使用通用運算元和區域/全域函式。 每個運算式都可以與某些內容相關聯，而且如果沒有任何運算式的運算結果為true，則可選擇有預設區段。 所有運算式都會依照其定義順序進行評估，並選取傳回true的第一個運算式，且該條件模組會傳回其關聯內容。

例如，如果信函中的條款與條件文字根據客戶所處的狀態而不同，且資料字典包含名為「state」的元素，則您可以新增條件，如下所示：
* state = NY，選取T&amp;C_NY文欄位落
* state = NC，選取T&amp;C_NC文欄位落

條件編輯器可讓您指定預設條件。 如果控制變數的值不符合任何條件，則會使用與預設條件相關聯的內容。 根據上一個範例，您可以新增此條件列：
* 預設，選取T&amp;C_Rest

### 建立條件 {#create-a-condition}

1. 選取 **Forms** > **檔案片段**.
1. 選取 **建立>條件**.
1. 為清單指定下列資訊：

   * **標題（選用）：** 輸入條件的標題。 標題不需要是唯一的，並且可以有特殊字元和非英文字元。 條件會透過其標題來參照（如果可用），例如在縮圖和資產屬性中。
   * **名稱：** 條件的唯一名稱。 任何狀態下都不可有兩個資產（文字、條件或清單）以相同名稱存在。 在「名稱」欄位中，您只能輸入英文字元、數字和連字型大小。 「名稱」欄位會根據「標題」欄位自動填入。 在「標題」欄位中輸入的特殊字元、空格、數字和非英文字元，會由「名稱」欄位中的連字型大小取代。 雖然「標題」欄位中的值會自動複製到「名稱」，但您可以編輯值。
   * **說明（選擇性）** 輸入條件的說明。
   * **資料字典（選擇性）**：選擇性地選取要連線的資料字典。 只有使用與條件相同資料字典的資產，或沒有指派資料字典的資產，才能新增至清單。 將資料字典指派給清單可讓建立信函範本的人員更輕鬆地找到合適的條件。
   * **標籤（選擇性）**：選擇性地選取要套用的標籤。 您也可以輸入新標簽名稱並建立它。 (當您選取「 」時，會建立新標籤 **儲存**.)

1. 選取&#x200B;**「下一步」**。
1. 選取 **新增資產**.
1. 若要將資產新增至條件，請在「選取資產」頁面中選取該資產，然後選取 **完成**. 資產會新增至「運算式」窗格。
1. 您可以選取下列選項，指定條件在執行階段的行為：

   * **停用多項結果評估\啟用多項結果評估**：啟用此選項（顯示為「啟用多個……」）時，會評估所有條件，而結果會是所有真正條件的總和。 如果停用此選項（顯示為「停用多個……」），則只會評估第一個被發現為true的條件，並成為條件的輸出。
   * **分頁符號**：選取此選項( ![中斷](assets/break.png))，在條件的模組之間新增分頁符號。 未選取此選項時( ![nobreak](assets/nobreak.png))，如果條件溢位至下一頁，則整個條件會移至下一頁，而非在條件之間的頁面中中斷。

1. 若要變更條件中資產的順序，請選取並按住箭頭圖示( ![拖放](assets/dragndrop.png) )和拖放。 當使用者在「建立通訊」使用者介面中開啟信函範本時，內容會依照您在此處定義的順序進行組裝。
1. 選取 **刪除** 以刪除列。 如果您為預設列選取「刪除」，則只會清除資產資訊。
1. 選取 **複製** 以複製列。
1. 選取 **編輯** 以變更資產或編輯運算式。

   進一步說明：

   * 若要更新資產，請選取「資產」欄下的資料夾圖示。
   * 若要開啟運算式產生器以插入運算式，請選取運算式欄下的資料夾圖示。 如需運算式產生器的詳細資訊，請參閱 [運算式產生器](/help/forms/using/expression-builder.md).

### 最佳實務/提示與秘訣 {#best-practices-tips-and-tricks-1}

* 使用一致的命名慣例以方便搜尋並避免重複。
* 條件的行為類似於case陳述式，因此條件的順序很重要。 會傳回第一個相符專案。
* 使用適當的資料字典繫結
* 使用條件編輯器編輯條件時，適用下列規則：

   * **新增變數：** 允許
   * **移除變數：** 允許
   * **屬性更新：** 允許
   * **變更資料字典：** 允許直到未使用資料字典元素為止。

## 布局片段 {#layoutfragments}

佈局片段以在Designer中建立的XDP為基礎。 若要建立佈局片段，您需要建立XDP和 [將其上傳至AEM Forms](/help/forms/using/import-export-forms-templates.md).

一個或多個佈局片段可以形成信函的部分並定義這些部分的圖形佈局。 佈局片段可以包含典型的表單欄位（例如地址和參考編號）以及表示目標區域的空白子表單。 此外，版面片段可讓您建立表格，並以字母插入表格。

常見的使用案例是找出字母中可重複使用的版面配置模式，並為它們建立版面配置片段。 例如，字母的問候語、地址和主旨部分，會以相同順序出現多個字母。 另一個範例可能是類似使用多個字母的列和欄數的表格。

您可以根據現有XDP建立佈局片段。 佈局片段可以由欄位和目標區域或一個或多個表格組成。 配置圖中的表格可以是靜態或動態。 XDP會在Designer中建立，並且 [已上傳至AEM Forms](/help/forms/using/import-export-forms-templates.md). XDP可以形成佈局片段或信函的結構。 更多相關資訊 [版面設計](/help/forms/using/layout-design-details.md).

使用繫結至目標區域的片段，可在編寫時變更字母。 您可以建立不同維度的佈局片段，並將適當的片段繫結到目標區域。 佈局片段也可讓您自訂某些表格屬性：

1. 您可以增加列數和欄數。
1. 您可以指定更多列和欄的頁首和頁尾文字。
1. 您可以定義表格欄寬的比率。 在執行階段會根據定義的比例和可用空間來調整表格欄的大小。 寬度比例的總和必須為100。 否則則不適用。
1. 如果表格是預留位置（僅包含單一空白儲存格），您可以定義新欄的型別（目標區域/欄位）。
1. 您可以隱藏頁首與頁尾列。

在執行此程式之前，請使用Designer建立XFA片段。 片段可以包含用於組織欄位和目標區域的表格。 Designer允許建立兩種型別的表格：靜態與動態。 靜態表格包含固定數量的列。 靜態表格可包含目標區域和欄位。 這些目標區域和欄位無法繫結到重複的DDE。 動態表格也可以有單一列。 繫結至表格儲存格的資料會決定動態表格的列數。 動態表格只能包含欄位。 DDE可以是重複或非重複。

設計表格時，請考量下列幾點：

1. 表格可在建立佈局片段時自訂。 不過，自訂選項只有在表格的父項子表單流動時才會啟用。
1. 對於動態表格，所有欄位、可重複的列和表格都會使用「使用名稱」繫結，讓資料正確合併。
1. 對於動態表格，所有繫結至表格欄位的重複DDE都是相同階層的一部分。 對於非重複的DDE，則沒有此類限制。
1. 將佈局片段合併到父級目標區域表格時，會根據可用空間調整大小，但只有當佈局片段不包含任何目標區域或直接位於頂層子表單中的欄位時，才會調整大小。 允許目標區域和表格內的欄位。
1. 您可以建立預留位置表格。 預留位置表格只有一個空白儲存格。

* 對於預留位置表格，您可以在建立片段時自訂以下屬性。

   * 列計數
   * 欄數
   * 每一欄的頁首與頁尾
   * 每欄的型別（目標區域/欄位）
   * 每一欄的寬度比例

* 對於非預留位置表格，您可以自訂下列屬性：

   * 列計數
   * 欄數
   * 其他欄的頁首和頁尾
   * 每一欄的寬度比例

您可以在信函中巢狀內嵌片段。 這表示您可以在片段中新增片段。 通訊管理解決方案支援信函內最多四個巢狀層級： **字母&#x200B;*>*片段&#x200B;*>*片段&#x200B;*>*片段&#x200B;*>*片段。**

如需在版面片段中使用靜態和動態表格的詳細範例，請參閱 [範例檔案的範例：在信函中使用靜態和動態表格](#examplewithsamplefiles).

### 建立佈局片段 {#creating-a-layout-fragment}

1. 選取 **建立** > **佈局片段**.
1. 通訊管理顯示可用的XDP。 選取您要作為佈局片段基礎的XDP，然後選取 **下一個**.
1. 為版面配置指定下列資訊：

   * **標題（選用）：** 輸入佈局片段的標題。 標題不需要是唯一的，並且可以有特殊字元和非英文字元。 配置片段由其標題（可用時）引用，例如在縮圖和資產屬性中。
   * **名稱：** 佈局片段的唯一名稱。 任何狀態下都不可有兩個資產（文字、條件或清單）以相同名稱存在。 在「名稱」欄位中，您只能輸入英文字元、數字和連字型大小。 「名稱」欄位會根據「標題」欄位自動填入。 在「標題」欄位中輸入的特殊字元、空格、數字和非英文字元，會由「名稱」欄位中的連字型大小取代。 雖然「標題」欄位中的值會自動複製到「名稱」，但您可以編輯值。 此名稱會顯示在「管理資產」使用者介面的清單中。
   * **說明（選擇性）**：說明會顯示在「管理資產」使用者介面的清單中。
   * **標籤（選擇性）**：選擇性地選取要套用至條件的標籤。 您也可以輸入新標簽名稱並建立它。

1. 選取 **表格** 標籤並指定配置圖的下列資訊：

   * **的設定**：選取正在設定的表格。如果表格是靜態表格，下拉式清單中表格名稱的尾碼為（靜態）；如果表格是動態表格，則為（動態）。 靜態表格包含固定數量的列。 靜態表格可包含目標區域和欄位。 這些目標區域和欄位無法繫結到重複的DDE。 繫結至表格儲存格的資料會決定動態表格的列數。

   * **列**：選取版面配置的列數。 設定的資料列計數必須大於或等於原始的資料列計數。
   * **欄**：選取配置的欄數。 設定的欄計數必須大於或等於原始欄計數。

   對於每個欄，需要以下詳細資料：

   * **頁首**：標題要顯示的文字
   * **頁尾**：為頁尾顯示的文字
   * **型別**：其他欄的型別。 欄位或目標區域。 已為靜態預留位置表格啟用型別。 型別可以在欄層級定義，而不是在儲存格層級定義。 延伸欄中的所有儲存格都是相同型別。 對於動態表格，所有欄都屬於欄位型別。 對於非預留位置表格，您無法定義其他欄的型別。 在此情況下，延伸欄中其他儲存格的型別與該列的最後一欄的型別相同；而額外列中的儲存格的型別與該欄的最後一個儲存格的型別相同。
   * **寬度比例：** 表格欄寬的比率。

   如需在版面片段中使用靜態和動態表格的詳細範例，請參閱 [範例檔案的範例：在信函中使用靜態和動態表格](#examplewithsamplefiles).

1. 選取「**儲存**」。

### 將XDP上傳至通訊管理 {#upload-an-xdp-to-correspondence-management}

如需上傳/匯入XDP至通訊管理的指示，請參閱 [將資產匯入及匯出至AEM Forms](/help/forms/using/import-export-forms-templates.md).

### 最佳實務/提示與秘訣 {#best-practices-tips-and-tricks-2}

#### 設定預設子表單繫結 {#set-the-default-subform-binding}

在Designer中建立目標區域時，將所有新子表單的預設繫結設定為「無」會有所幫助。

若要設定預設繫結：

1. 在設計器中，選取 **工具** > **選項** > **資料繫結** > **子表單繫結**.

1. 在「新子表單的預設繫結」清單中，選取 **無資料繫結**.

這可確保使用「插入」>「子表單」指令或從「物件浮動視窗」拖放插入的子表單預設具有「無」繫結。 這表示依預設，任何新的子表單都是目標區域，除非您新增內容、變更其繫結設定，或以「_int」字尾命名子表單。

#### 符合第508節 {#section-compliance}

如果在「建立通訊」使用者介面中建立的已完成信函用於填寫之後的工作流程。 在建立版面配置時，請遵循這些與Section 508相關的建議。 否則，字母PDF會用於顯示，您可以忽略這些建議：

* 所有目標區域子表單和版面配置中的所有欄位都有定位鍵順序。
* 預設情況下，包含字幕的欄位與508相容。 該欄位的/field/assist/speak@priority屬性預設為「custom」，這表示除非提供自訂熒幕助讀程式文字，否則熒幕助讀程式會讀取欄位的標題。
* 沒有標題的欄位會指定工具提示，並指示熒幕閱讀程式透過設定來閱讀工具提示

`/field/assist/speak@priority="toolTip"` 並在中指定工具提示文字 `/field/assist/toolTip`.

#### Designer和Asset Configuration Manager中的日期格式 {#date-formats-in-designer-and-asset-configuration-manager}

在Designer中設計版面時，請確保日期欄位的格式符合中資料顯示格式中指定的日期格式 [通訊管理設定屬性](/help/forms/using/cm-configuration-properties.md). 如需詳細資訊，請參閱設計工具說明中的「格式化欄位值及使用模式」。

#### 擷取日期範圍 {#capturing-date-ranges}

在處理日期組合（例如startDate - endDate）時，請使用單一子表單以確保完成的字母正確對齊，並將欄位數減至最少。

#### 設定表單層級繫結 {#setting-form-level-binding}

當配置包含許多對應至單一XML元素的欄位和目標區域時，請使用表單層級繫結，並為每個元素建立個別的節點。 在「通訊管理」中對應資料時，會忽略在表單層級繫結的欄位。

#### 請勿在主版頁面中使用子表單目標區域 {#do-not-use-subform-target-areas-in-a-master-page}

主版頁面中的子表單目標區域在「管理資產」使用者介面中不可見，且資料無法對應至這些區域。

#### 為目標區域選擇適當的位置和型別 {#choosing-appropriate-positions-and-types-for-target-areas}

設計版面時，請謹慎選擇子表單。 如果版麵包含單一子表單，則可為流程型別。 在子表單中放置欄位後，您可以將它包裝在另一個子表單中，這樣包裝的子表單也能流動，版面不會受到干擾。

#### 在主版頁面上放置欄位 {#placing-fields-on-master-pages}

當您在主版頁面上放置欄位時，請注意下列事項：

* 設定主版頁面欄位的繫結為「使用全域資料」
* 請勿將欄位直接置於主版頁面的根PageArea之下。
* 將欄位包裝在已命名的子表單中，並確保已命名的子表單的繫結已設定為「使用名稱」。

## 使用佈局片段建立表格 {#creating-tables-using-layout-fragments}

許多信函範本都包含表格。 表格可以是靜態的，例如條款與條件表格，其中每一列代表一個條件，而每一部分都顯示在單獨的欄中。 表格也可以是動態的，例如帳戶資訊，其中包含客戶名稱、帳戶ID、交易編號及交易金額等資訊。

* **靜態表格**：表格有時是以具有不同欄數的列來建立，例如條款和條件的表格。 其中每一列代表一個條件，而每個條件可以有不同的子部分。 每個零件都會顯示在單獨的欄中。
* **動態表格**：佈局片段提供將動態表格的欄位繫結至集合DDE的功能。 產生信函時，會根據集合DDE的大小產生表格列。

DD具有收集元素Nominied_details，其具有三個原始元素的複合元素：Nominied_name、Nominied_address和Nominied_gender。
動態XDP也有相同的標題。 因此，您可以使用上述的DD欄位對應動態XDP欄位。

### 範例檔案的範例：在信函中使用靜態和動態表格 {#examplewithsamplefiles}

此範例說明如何建立動態與靜態表格、將動態表格繫結至DDE，然後建立包含這兩個表格的字母。 使用此範例時，您可以從頭開始建立檔案，或使用步驟中提供的輸入檔案。

1. 建立您要在範例中使用的資料字典(DD)，如圖形所示。

   然後選取DD並匯出範例資料。 您取得的XML檔案包含Employee資料和3個Nominee_details例項（依預設會下載3個例項）。 您可以依需求新增或刪除)。 更新值，然後將測試資料匯入DD。 CMP檔案是套件，其中包含DD。 因此，請將DD匯入Correspondence Management。

   如需使用資料字典和測試資料的詳細資訊，請參閱 [資料字典](/help/forms/using/data-dictionary.md#p-working-with-test-data-p).

   ![資料字典結構](assets/dd.jpeg)

[取得檔案](assets/exportpackage_1431709897770.cmp.zip)

1. 在Designer中，建立兩個XDP （佈局片段）：動態表格和靜態表格。 針對這兩種版面：

   * 新增子表單至表格欄。 請確定您將表格父項子表單的版面配置變更為flowed，並移除表格中子表單的繫結。
   * 新增子表單至表格儲存格。 請確定您將表格父項子表單的版面配置變更為flowed，並移除表格中子表單的繫結。

   或者，使用此步驟附加的靜態和動態XDP。

   如需使用佈局片段的詳細資訊，請參閱 [佈局片段](#layoutfragments).
如需設計版面的詳細資訊，請參閱 [Designer說明](https://help.adobe.com/en_US/AEMForms/6.1/DesignerHelp/).

[取得檔案](assets/static.xdp.zip)

[取得檔案](assets/dynamic.xdp.zip)

1. 將XDP上傳至AEM Forms。
1. 根據動態XDP建立佈局片段。 屬性的「表格」標籤顯示表格是動態的(「組態對象」(Configuration For)欄位)。 列數(1)和欄數(3)衍生自XDP/佈局片段。

   此配置的欄位稍後會繫結至匯入的DD，而在信函中，資料列數目會根據測試資料檔案（附加於DD的XML資料檔案）中的記錄數目動態建立。

   ![建立佈局片段畫面](assets/dynamictableproperties.png)

   按一下以開啟全尺寸影像

1. 根據靜態XDP建立佈局片段。 屬性的「表格」標籤會顯示表格是靜態的(「組態對象」(Configuration For)欄位)。 列數(1)和欄數(3)衍生自XDP/佈局片段。

   您可以在此變更欄數和列數。 根據您在此畫面中選擇的內容，靜態表格的列數和欄數在以此版面配置建立的信函中保持固定。
   [![建立佈局片段畫面](assets/statictableproperties.png)](assets/statictableproperties-1.png)

1. 使用其中的佈局片段建立字母。 在信函中插入動態XDP時，請將其欄位繫結設定為資料字典的集合元素。

   如需建立信件和信件範本的詳細資訊，請參閱 [建立字母](/help/forms/using/create-letter.md).

1. 儲存信函並預覽。 預覽信函時，資料字典中的值會顯示在信函中。 對於動態表格，有三個資料列。 這是因為測試資料針對這些列有三個記錄。

   對於靜態表格，顯示的列和欄數會與您在建立版面片段時指定的相同。

   ![信函中的靜態表格](assets/statictableletter.png)

   對於動態表格，會根據測試資料檔案中的記錄數來顯示三列。 發生此狀況是因為將版面配置新增至信函時，您建立了動態表格欄位與資料字典的集合元素之間的繫結。 「名稱」、「地址」和「性別」值會從您使用的測試資料檔案中填入。

   ![信函中的動態表格](assets/dynamictableletter.png)

## 建立檔案片段的復本 {#create-a-copy-of-a-document-fragment}

若要快速建立具有與現有檔案片段類似之屬性和內容的檔案片段，您可以複製並貼上它。

1. 從檔案片段清單中，選取一或多個檔案片段。 UI會顯示「複製」圖示。
1. 選取「複製」。 UI會顯示「貼上」圖示。 您也可以選擇在貼上之前先移至資料夾內。 不同的資料夾可以包含名稱相同的資產。 如需檔案夾的詳細資訊，請參閱 [資料夾和組織資產](/help/forms/using/import-export-forms-templates.md#folders-and-organizing-assets).
1. 選取「貼上」。 「貼上」對話方塊隨即顯示。 如果您要在相同位置複製和貼上檔案片段，系統會自動為信函的新副本指定名稱和標題，但您可以編輯信函的標題和名稱。
1. 如有必要，請編輯您想要用來儲存檔案片段副本的「標題」和「名稱」。
1. 選取「貼上」。 檔案片段的副本隨即建立。
