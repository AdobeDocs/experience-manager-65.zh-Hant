---
title: 文件片段
seo-title: 文件片段
description: 「對應管理」中的「文字」、「清單」、「條件」和「版面」片段，可讓您建立客戶對應的靜態、動態和可重複的元件。
seo-description: 「對應管理」中的「文字」、「清單」、「條件」和「版面」片段，可讓您建立客戶對應的靜態、動態和可重複的元件。
uuid: 4273323d-14f5-4b3b-8fed-80beef641efe
topic-tags: correspondence-management
products: SG_EXPERIENCEMANAGER/6.5/FORMS
discoiquuid: 0d5436c6-1976-496c-b9a7-7dc6e830bb5d
docset: aem65
feature: Correspondence Management
translation-type: tm+mt
source-git-commit: 48726639e93696f32fa368fad2630e6fca50640e
workflow-type: tm+mt
source-wordcount: '6935'
ht-degree: 0%

---


# 文件片段{#document-fragments}

## 文件片段 {#document-fragments-1}

檔案片段是可重複使用的信件部分／元件，您可使用這些元件來合成信件／信件。 檔案片段的類型如下：

* **文字**:文字資產是由一或多個文欄位落組成的內容片段。段落可以是靜態或動態。
* **清單**:清單是一組檔案片段，包括文字、清單、條件和影像。清單元素的順序可以是固定或可編輯的。 在建立字母時，您可以使用部分或全部的清單元素來複製可重複使用的元素模式。
* **條件**:條件可讓您根據提供的資料，定義在建立對應時包含的內容。該條件用控制變數來描述。 控制變數可以是資料字典元素或預留位置。
* **版面片段**:版面片段是可用於一或多個字母的版面。配置片段可用來建立可重複的圖樣，尤其是動態表格。 版面可包含「位址」和「參考編號」等典型表單欄位。 它還包含表示目標區域的空子表單。 版面(XDP)是在Designer中建立，然後上傳到AEM Forms。

## 文字 {#text}

文字資產是由一或多個文欄位落組成的內容片段。 段落可以是靜態或動態。 動態段落包含資料元素的參考，其值在執行時期提供。 例如，字母稱呼中的客戶名稱可以是動態資料元素，其值可在執行時期使用。 透過變更這些值，可以使用相同的字母範本為不同的客戶產生字母。

對應管理解決方案支援兩種動態資料項（可變資料）:

* **資料字典元素**:這些元素會系結至資料字典，並從提供的資料來源取得其值。資料字典變數可以受到保護或不受保護。 在建立對應時，使用者可以修改未受保護資料字典變數的預設值，但無法修改受保護的字典變數。
* **佔位符**:這些變數不會系結至後端資料來源。它們會要求使用者在建立通訊時填入值。 預設情況下，預留位置不受保護。

>[!NOTE]
>
>建立預留位置時，「對應管理」範本不會強制您建立唯一名稱。 如果建立兩個具有相同名稱的佔位符（如文本和條件），並在字母模板中同時使用它們，則最後插入的佔位符的值將用於這兩個佔位符。 如果兩個佔位符具有相同名稱，則會比較其類型。 如果類型不同，則其類型將變為字串。 但是，在模組中，不能建立同名的多個佔位符。

### 建立文字{#create-text}

1. 選擇&#x200B;**Forms** > **文檔片段**。
1. 點選「**建立** > **文字**」或選取文字資產並點選「編輯&#x200B;**編輯**」。
1. 指定文字的下列資訊：

   * **標題：（可選）** 輸入文字資產的標題。標題不必是唯一的，可以有特殊字元和非英文字元。 文字會以標題（如果有的話）來參照，例如縮圖和資產屬性。
   * **名稱：** 文字資產的唯一名稱。任何狀態下都不能有兩個資產（文字、條件或清單）具有相同的名稱。 在「名稱」欄位中，您只能輸入英文字元、數字和連字型大小。 「名稱」欄位會根據「標題」欄位自動填入。 在「標題」欄位中輸入的特殊字元、空格、數字和非英文字元將在「名稱」欄位中替換為連字元。 雖然「標題」欄位中的值會自動複製到「名稱」，但您可以編輯值。
   * **說明**:輸入資產說明。
   * **資料字典**:（可選）選擇要映射的資料字典。此屬性可讓您在文字資產中新增資料字典元素的參考。
   * **標籤**:（可選）要建立自定義標籤，請在文本欄位中輸入值，然後按Enter。您可以在標籤的文字欄位下方看到標籤。 儲存此文字時，也會建立新增的標籤。

1. 點選&#x200B;**Next**。 「對應管理」顯示「編輯器」頁面，您可以在該頁面中向文本添加文本段落和資料元素。

   瀏覽器中的預設拼字檢查器會在文字編輯器中檢查拼字。 若要管理拼字檢查和語法檢查，您可以編輯瀏覽器的拼字檢查器設定，或安裝瀏覽器外掛程式／地址以檢查拼字檢查和語法。

   您也可以使用文字編輯器中的各種鍵盤快速鍵來管理、編輯和格式化文字。 有關「通信管理鍵盤快捷鍵」中[文本編輯器](/help/forms/using/keyboard-shortcuts.md#p-formatting-p)鍵盤快捷鍵的詳細資訊。

1. 文本編輯器開啟，輸入文本。 使用頁面頂端的工具列來格式化文字、插入條件、連結和分頁符。

   ![工具列](assets/advancedediting.png)

   * **連結**:在文 [](#insert-hyperlink) 字中插入hypertextlink。
   * **重複**:使用分隔字元，重複列印「資料字典」中的收集元素。
   * **條件**:點選以插入條件。根據條件插入文字。 如果條件為true，則文字會以字母顯示，否則不顯示。
   * **添加說明**:將註解新增至文字。這是作者可見的中繼資料，但不是所建立之字母的一部分。
   * **分頁符**:如果將文本模組的分頁屬性設定為false，則文本模組不會跨頁分頁。

   文字編輯器隨即開啟。 輸入文本。 工具列會依您選擇進行的編輯類型而變更：段落、對齊或清單：

   ![選擇工具列類型](assets/toolbarselection.png)

   選擇工具列類型：段落、對齊或清單

   ![段落工具列](assets/fonteditingtoolbar.png)

   段落工具列
   [ ![對齊工具](assets/paragrapheditingtoolbar.png)](assets/paragrapheditingtoolbar-1.png)列對齊工具列

   ![清單工具欄](assets/bulleteditingtoolbar.png)

   清單工具列（按一下以開啟全尺寸影像）

1. 若要重複使用其他應用程式（例如從MS Word或HTML頁面）中存在的多個文欄位落，請將文字複製並貼入文字編輯器。 複製的文本的格式將保留在文本編輯器中。

   您可以在可編輯的文字模組中複製和貼上一或多個文欄位落。 例如，您可能有MS Word檔案，其中包含可接受的居住證明項目清單，如下所示：

   ![pastetextmsword-1](assets/pastetextmsword-1.png)

   您可以直接將MS Word檔案中的文字複製並貼至可編輯的文字模組。 文字模組會保留項目清單、字型和文字顏色等格式。

   ![pastextextmodule](assets/pastetexttextmodule.png)

   >[!NOTE]
   >
   >不過，貼上的文字格式有一些[限制](https://helpx.adobe.com/aem-forms/kb/cm-copy-paste-text-limitations.html)。

1. 如果需要，請在文檔片段中插入特殊字元。 例如，您可以使用「特殊字元」浮動視窗來插入：

   * 貨幣符號，例如€、¥和英鎊
   * 數學符號，如∑、√、÷和^
   * 標點符號‟，例如&quot;

   ![specialcharacters-1](assets/specialcharacters-1.png)

   Commense Management已內建210個特殊字元的支援。 管理員可以透過自訂](/help/forms/using/custom-special-characters.md)新增對更多／自訂特殊字元的支援。[

1. 若要在可編輯的內嵌模組中反白\強調部分文字，請選取文字並點選「反白顯示顏色」。

   ![文本背景著色](assets/textbackgroundcolorapplied.png)

   您可以直接點選「基本顏色」浮動視窗中顯示的基本顏色`**[A]**`，或在使用滑桿`**[B]**`後點選「選取&#x200B;****」，以選擇適當的顏色陰影。

   或者，您也可以前往「進階」標籤，選取適當的「色相」、「明度」和「飽和度」 `**[C]**`以建立精確的色彩，然後點選「選取`**[D]**`」以套用色彩來反白顯示文字。

   ![textbackgroundcolor-1](assets/textbackgroundcolor-1.png)

1. 從資料面板，將資料字典元素和預留位置元素拖放至文字。

   至:

   * 在文字中新增資料字典元素，從清單中選取資料元素，然後點選「插入」(![insert](assets/insert.png))。 如果您選擇「受保護」，資料字典元素是唯讀的，會出現在字母編輯器中，但不會出現在「建立對應」使用者介面或「對應製作程式」中。
   * 在文字中新增預留位置元素，在「資料元素」面板中點選「建立新」，輸入新「資料元素」的詳細資料，點選「建立」，將新元素新增至清單。 新的放置器可以與資料字典元素相同的方式插入到文本中。 若要編輯預留位置，請選取預留位置，然後點選「編輯」。

   ![預留位置元素](assets/placeholder_elements_in_xmldata.png)

   資料字典的範例資料檔案中指定的預留位置元素

   ![字母中的預留位置元素](assets/placeholder_elements_in_text.png)

   CCR視圖中的佔位符元素值從資料字典變數中填充，如示例資料檔案中所指定

   您也可以使用@符號來搜尋資料字典和預留位置元素，並將它們新增至文字編輯器。 將游標置於要插入元素的位置。 鍵入@ ，後面跟搜索字串。 文本編輯器對文本文檔片段中可用的所有資料字典和佔位符元素執行搜索操作。 搜索操作將檢索包含搜索字串的元素並將其作為下拉清單顯示。 瀏覽搜尋結果，然後按一下您要在游標位置插入的元素。 按Esc可隱藏搜尋結果。

1. 您可以使用內嵌條件並重複，讓您的字母具有高度情境化且結構化。 有關內嵌條件和重複的詳細資訊，請參閱[內嵌條件，並在字母中重複。](/help/forms/using/cm-inline-condition.md)
1. 點選&#x200B;**Save**。

#### 在文字{#insert-hyperlink}中插入超連結

執行下列步驟，在文字資產中建立超連結：

1. 在文本編輯器中選擇文本或資料模型對象。

2. 點選&#x200B;**[!UICONTROL Link]**。 點選「**[!UICONTROL Alt Text]**」欄位以移除現有的資料模型物件名稱或文字。

3. 指定URL並點選![Save](assets/save_icon.svg)。

![在文字資產中建立超連結](assets/text-create-hyperlink.png)

#### 搜索和替代文字{#searching-and-replacing-text}

使用包含大量文字的文字元素時，您需要搜尋特定的文字字串。 您也可能需要以替代字串取代特定文字字串。

「尋找和取代」功能可讓您搜尋（和取代）文字元素中的任何文字字串。 此功能也包含強大的規則運算式搜尋功能。

#### 在文本模組{#to-search-text-in-a-text-module}中搜索文本

1. 在文字編輯器中開啟文字模組。

1. 點選「尋找和取代」。
1. 在「查找」文本框中輸入要搜索的文本，然後按「查找」。 搜索文本在文本模組中突出顯示。
1. 要搜索下一個文本實例，請再次按「查找」。

   如果繼續按「查找」按鈕，則搜索將繼續到頁面下方。 在找到文本的最後一個實例後，消息&#x200B;**模組**&#x200B;的「已到達」結尾表示未找到更多搜索結果。

   但是，如果文本模組中未找到搜索文本的實例，則顯示的消息為：**找不到匹配**。

1. 如果您再次按「尋找」，搜尋會繼續在頁面頂端進行。

#### 搜尋選項{#search-options}

**比對大小寫：** 搜尋只會傳回大小寫相同的結果。

**完整單字：** 搜尋只會傳回完整單字。

>[!NOTE]
>
>如果在「查找」文本框中輸入任何特殊字元，則會禁用「全字」選項。

**Reg ex：使用** 規則運算式搜尋。例如，下列規則運算式會在文字模組中搜尋電子郵件地址：

`[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}`

#### 要搜索和替代文字模組{#to-search-and-replace-text-in-a-text-module}中的文本

1. 在文字編輯器中開啟文字模組。
1. 點選「尋找和取代」。
1. 在「查找」文本框中輸入要搜索的文本，並輸入要用查找文本替換的文本，然後按「替換」。
1. 如果找到搜尋文字，文字會以「取代」文字取代。

   * 如果找到另一個搜索文本實例，該實例將在文本模組中突出顯示。 如果再次按「替換」(Replace)，則替換突出顯示的實例，並且如果找到第三個實例，游標將向前移動。
   * 如果找不到另一個實例，游標將停止在最後一個替換的實例上。

1. 如果您再次按「尋找」，搜尋會繼續在頁面頂端進行。

   使用「全部替換」選項替代文字模組中的所有文本實例。 執行「」操作時，替換項的數量將在「查找和替換」(Find and Replace)對話框中顯示為一條消息。

#### 文字模組{#best-practices-tips-and-tricks-for-text-modules}的最佳做法／秘訣與訣竅

* 使用一致的命名慣例以避免重複。
* 在文字模組中使用適當的資料字典系結。
* 在變更文字資產時，使用文字編輯器時適用下列規則：

   * **新增變數：允** 許
   * **移除變數：允** 許
   * **更新屬性：允** 許
   * **變更資料字典：** 允許直到未使用資料字典元素為止。更新時無法變更資料字典。

## 清單 {#list}

清單是一組檔案片段，包括文字、（其他）清單、條件和影像。 清單元素的順序可以是固定或可編輯的。 在建立字母時，您可以使用部分或全部的清單元素來複製可重複使用的元素模式。 清單基本上會以可在其他目標內巢狀化的目標方式運作。

### 實作清單{#implementing-lists}

實作清單包含兩個步驟：

1. 定義核心屬性，例如名稱、說明、資料字典。
1. 屬於清單一部分的內容區段，然後設定清單的屬性，例如鎖定順序和資料庫存取權。

### 建立清單{#create-a-list}

清單是一組相關內容，可在字母範本中以單一單位使用。 任何類型的內容都可以新增至清單。 清單也可以巢狀化。 可將清單模組指定為：

* **訂購**:在「建立對應」執行階段中，無法變更順序。
* **資料庫存取**:用戶可以將模組添加到清單中。此標幟指定是否啟用程式庫存取。 如果啟用（開啟），使用者可以在預覽字母時將模組新增至清單。
* 建立清單時，您可以指定類型，例如：
* **簡單**:清單中不會應用其他樣式格式。
* **項目符號**:以簡單項目符號格式化的清單。
* **編號**:選擇「標準」(1,2,...)、「上羅馬」(I,II,...)和「下羅馬」(i,ii,...)數字的數字清單。
* **Lettered**:字母順序清單，可選擇小寫(a,b,...)和大寫(A,B,...)字母。
* **自訂**:您可以建立任何編號／字母類型，以及您選擇的首碼和尾碼值。

1. 選擇&#x200B;**Forms** > **文檔片段**。

1. 選擇&#x200B;**建立** > **清單**。

1. 指定清單的下列資訊：

   * **標題（可選）:輸** 入清單的標題。標題不需要唯一，而且可以有特殊字元和非英文字元。 清單會以其標題（如果有的話）來參照，例如縮圖和資產屬性。
   * **名稱：** 清單的唯一名稱。任何狀態下都不能有兩個資產（文字、條件或清單）具有相同的名稱。 在「名稱」欄位中，您只能輸入英文字元、數字和連字型大小。 「名稱」欄位會自動填入「標題」欄位中的值。 在「標題」欄位中輸入的特殊字元、空格、數字和非英文字元將在「名稱」欄位中替換為連字元。 雖然「標題」欄位中的值會自動複製到「名稱」，但您可以編輯值。
   * **說明（可選）**:輸入資產說明。
   * **資料字典（選用）**:（可選）選擇要連接的資料字典。只有使用與清單相同的資料字典的資產，或沒有指派資料字典的資產，才能新增至清單。 將資料字典指派至清單可讓建立字母範本的人員更容易找到適當的清單。
   * **標籤（可選）**:選取要套用的標籤。您也可以輸入新標籤的名稱並加以建立。 （當您點選&#x200B;**Save**&#x200B;時，會建立新標籤。）

1. 點選&#x200B;**Next**。
1. 點選&#x200B;**新增資產**。
1. 若要將資產新增至清單，請在「選取資產」頁面中選取資產，然後點選&#x200B;**Done**。

   ![選取要新增至清單的資產](assets/selectassets.png)

1. 資產會新增至「清單項目」頁面。
若要變更清單中資產的順序，請點選並按住箭頭圖示(![dragndrop](assets/dragndrop.png))和拖放。 當使用者在「建立對應」使用者介面中開啟字母範本時，內容會依您在此定義的順序組合。

   ![在清單中重新排序及設定資產](assets/listitems.png)

1. 您可以選擇以下選項來指定清單在CCR用戶介面中的行為：

   * **資料庫存取**:若要啟用資料庫存取以新增資產，請點選「資料庫存取」。啟用「資料庫存取」後，索賠調整者可以新增更多內容至清單。 否則，「索賠調整者」僅限於您為清單定義的內容。
   * **鎖定順序**:要鎖定清單中資產的順序，以便索賠調整者不能更改順序，請按一下「鎖定順序」。如果您未選擇此選項，「索賠調整者」可以更改清單項的順序。

   * **新增項目符號**:使用此選項可將項目符號或編號樣式應用於模組。您可以使用預先設計的清單樣式或自訂的清單樣式。 您也可以指定在每個清單項目前後顯示的文字。
   * **分頁符**:選取此選項( ![分頁](assets/break.png))可在清單內容之間新增分頁符。如果未選取此選項(![nobreak](assets/nobreak.png))，如果清單的內容溢出至下一頁，則整個清單會移至下一頁，而非在清單之間的頁面中斷。

   * **分配配置**:使用此選項可指定可新增至清單的資產數量下限和上限。

1. 您可以選取下列選項，以指定清單中每個資產在執行時期的運作方式：

   * **可編輯：** 選取此選項時，可在「建立對應」使用者介面中編輯內容。（此選項不適用於「清單」和「影像」模組。）
   * **必要：選** 取此選項時，「建立對應」使用者介面中必須包含內容。
   * **選取：選** 取此選項時，內容會在「建立對應」使用者介面中預先選取。
   * **略過樣式：選** 取此選項時，內容會跳過「建立對應」使用者介面中的項目符號和編號。(此選項不適用於映像模組。 此外，在「跳過樣式」、「複合」和「忽略清單樣式」之間，只能將其中一個選項應用於模組。 當您為模組選擇「添加項目符號」時，這些選項之一可用於模組。)
   * **縮排：** 可以更改作為清單一部分選擇的每個模組／內容的縮排級別。縮進是以「級別」（從零開始）的形式指定的，因此每個縮進級別對應36pts的間距。
   * **複合：** 選中此選項時，複合編號將作為外部（父）清單樣式及其自身樣式的組合應用。此嵌套清單上的複合編號基於此嵌套清單在外部清單中的顯示順序。
   * **忽略清單樣式：** 如果取消選擇了「複合編號」選項，則啟用了「忽略清單樣式」選項。此選項會忽略嵌套清單的自有樣式，編號會從外部清單繼續。 因此，嵌套清單的模組將視為外部清單本身的一部分，忽略嵌套清單上指定的任何樣式。 如果為嵌套清單取消選擇了「忽略清單樣式」選項，作為該嵌套清單一部分的模組具有自己的編號樣式。
   * **與下一步保持** 在一起：設定清單中所含資產的分頁符。如果您將清單中某個資產的「與下一個資產保持」屬性設為&#x200B;**On**，則該資產和下一個資產會維持在相同頁面上。 這表示選取資產和下一個資產的內容不會跨頁中斷。

1. 點選&#x200B;**Save**。

### 最佳實務／秘訣與訣竅{#best-practices-tips-and-tricks}

* 使用一致的命名慣例以避免重複。
* 使用適當的資料字典系結
* 使用「清單編輯器」變更清單時，會套用下列規則：

   * 屬性更新：允許
   * **變更資料字典：** 允許直到沒有使用資料字典的項目與其相關聯為止。更新時無法變更資料字典。

## 條件 {#conditions}

條件可讓您根據提供的資料，定義在建立信件／信件時所包含的內容。 該條件用控制變數來描述。 新增條件時，您可以選擇根據控制變數的值加入資產。

根據您選擇的選項，僅評估根據當前條件變數找到的第一個表達式或所有條件。 在「建立對應」(CCR)中填寫字母時，條件的行為為「白框」。 如果條件導致清單，則輸出清單的所有必需和預選項目。 如果其中任何項目本身是條件或清單，則其產生的內容也會以自上向下、深度優先順序輸出為文字和影像內容的平面清單。 條件結果可以是任何類型（文字、清單、條件或影像）。

### 實施條件{#implementing-conditions}

條件編輯器隨附[運算式產生器](/help/forms/using/expression-builder.md)使用者介面，支援使用多個預留位置和資料字典元素來建立運算式。 您可以在這些運算式中使用通用運算元和局部／全域函式。 每個運算式都可與某些內容關聯，而且如果任何運算式都未評估為true，則可能有預設區段。 所有運算式都會依其定義順序進行計算，並選取返回true的第一個運算式，其相關內容會由該條件模組傳回。

例如，如果字母中的詞語和條件文字因客戶所在的狀態而異，而資料字典包含名為「state」的元素，則您可以按如下方式新增條件：
· state = NY, select T&amp;C_NY text paragraph
·狀態= NC，選擇T&amp;C_NC文本段落

條件編輯器可讓您指定預設條件。 如果控制變數的值不符合任何條件，則會使用與預設條件相關聯的內容。 在上一個範例之後，您可以新增此條件列：
·預設，選取「T&amp;C_Rest」

### 建立條件{#create-a-condition}

1. 選擇&#x200B;**Forms** > **文檔片段**。
1. 選擇&#x200B;**建立>條件**。
1. 指定清單的下列資訊：

   * **標題（可選）:** 輸入條件的標題。標題不需要唯一，而且可以有特殊字元和非英文字元。 條件會以標題（如果有的話）來參照，例如縮圖和資產屬性。
   * **名稱：** 條件的唯一名稱。任何狀態下都不能有兩個資產（文字、條件或清單）具有相同的名稱。 在「名稱」欄位中，您只能輸入英文字元、數字和連字型大小。 「名稱」欄位會根據「標題」欄位自動填入。 在「標題」欄位中輸入的特殊字元、空格、數字和非英文字元將在「名稱」欄位中替換為連字元。 雖然「標題」欄位中的值會自動複製到「名稱」，但您可以編輯值。
   * **說明（可選）** 鍵入條件的說明。
   * **資料字典（選用）**:（可選）選擇要連接的資料字典。只有使用與條件相同的資料字典的資產，或沒有指派資料字典的資產，才能新增至清單。 將資料字典指派至清單可讓建立字母範本的人員更容易找到適當的條件。
   * **標籤（可選）**:（可選）選擇要應用的標籤。您也可以輸入新標籤的名稱並加以建立。 （當您點選&#x200B;**Save**&#x200B;時，會建立新標籤。）

1. 點選&#x200B;**Next**。
1. 點選&#x200B;**新增資產**。
1. 若要將資產新增至條件，請在「選取資產」頁面中選取資產，然後點選&#x200B;**Done**。 資產會新增至「運算式」窗格。
1. 您可以選取下列選項，以指定條件在執行時期的運作方式：

   * **禁用多結果評估\啟用多結果評估**:啟用此選項（顯示為「啟用多個……」）時，會評估所有條件，結果是所有真實條件的總和。如果此選項已停用（顯示為「停用多個……」），則只會評估第一個發現為true的條件，並成為條件的輸出。
   * **分頁符**:選取此選項( ![break](assets/break.png))，在條件的模組之間新增分頁符。如果未選取此選項(![nobreak](assets/nobreak.png))，如果條件溢出至下一頁，則整個條件會移至下一頁，而非在條件之間的頁面中斷。

1. 若要變更條件中資產的順序，請點選並按住箭頭圖示(![dragndrop](assets/dragndrop.png))和拖放。 當使用者在「建立對應」使用者介面中開啟字母範本時，內容會依您在此定義的順序組合。
1. 點選&#x200B;**Delete**&#x200B;以刪除該行。 如果您針對預設列點選「刪除」，則只會清除資產資訊。
1. 點選&#x200B;**Copy**&#x200B;複製列。
1. 點選「**編輯**」以變更資產或編輯運算式。

   進一步：

   * 若要更新資產，請點選「資產」欄下的資料夾圖示。
   * 若要開啟運算式產生器以插入運算式，請點選「運算式」欄下的資料夾圖示。 如需運算式產生器的詳細資訊，請參閱「運算式產生器」[。](/help/forms/using/expression-builder.md)

### 最佳實務／秘訣與訣竅{#best-practices-tips-and-tricks-1}

* 使用一致的命名慣例，以方便搜尋並避免重複。
* 條件的行為與大小寫陳述式類似，因此條件順序很重要。 會傳回第一個相符項目。
* 使用適當的資料字典系結
* 使用條件編輯器編輯條件時，適用下列規則：

   * **新增變數：允** 許
   * **移除變數：允** 許
   * **更新屬性：允** 許
   * **變更資料字典：** 允許直到未使用資料字典元素為止。

## 布局片段 {#layoutfragments}

版面片段是以在Designer中建立的XDP為基礎。 若要建立版面片段，您必須建立XDP並將XDP上傳至AEM Forms](/help/forms/using/import-export-forms-templates.md)。[

一或多個版面片段可以形成字母的部分，並定義這些部分的圖形版面。 版面片段可包含典型的表單欄位，例如「位址」和「參考編號」，以及表示目標區域的空子表單。 此外，版面片段可讓您建立表格並將它們插入字母中。

常見的使用案例是在字母中找出可重複使用的版面模式，並為它們建立版面片段。 例如，字母的問候語、地址和主旨部分，按同一順序顯示多個字母。 另一個例子可以是多個字母中使用的行和列數相似的表。

您可以根據現有的XDP建立版面片段。 版面片段可由欄位和目標區域或一或多個表格組成。 版面中的表格可以是靜態或動態的。 XDP在Designer中建立，並且[上傳到AEM Forms](/help/forms/using/import-export-forms-templates.md)。 XDP可以形成佈局片段或字母的結構。 有關[版面設計](/help/forms/using/layout-design-details.md)的詳細資訊。

使用系結至目標區域的片段，可讓字母在製作時變更。 可建立不同尺寸的版面片段，並將適當的片段系結至目標區域。 配置片段也可讓您自訂部分表格屬性：

1. 您可以增加列和列計數。
1. 您可以指定更多行和欄的頁首和頁尾文字。
1. 可以定義表列寬度的比例。 在執行時期表格欄會根據定義的比例和可用空間來調整大小。 寬度比之和必須為100。 否則不適用。
1. 如果表是佔位符（僅包含單個空格單元格），則可定義新列的類型（目標區域／欄位）。
1. 您可以隱藏頁首和頁尾行。

在執行此過程之前，請使用設計器建立XFA片段。 片段可包含用於組織欄位和目標區域的表格。 設計人員允許建立兩種類型的表：靜態和動態。 靜態表包含固定的行數。 靜態表可以包含目標區域和欄位。 這些目標區域和欄位不能綁定到重複的DDE。 動態表格也可以有單一列。 系結至表格儲存格的資料會決定動態表格的列數。 動態表格只能包含欄位。 DDE可以是重複的或非重複的。

在設計表格時，請考慮以下幾點：

1. 可在建立版面片段時自訂表格。 但是，僅當表的父子表單被流動時，才啟用自定義選項。
1. 對於動態表，所有欄位都可重複行和表使用「使用名稱」綁定來正確合併資料。
1. 對於動態表，所有綁定到表欄位的重複DDE都屬於同一層次。 對於不重複的DDE，沒有此類限制。
1. 在將版面片段合併為上層目標區域表格時，會根據可用空間來調整大小，但只有在版面片段不包含任何目標區域或欄位直接在頂層子表單中時，才會調整大小。 允許目標區域和表內欄位。
1. 可以建立佔位符表。 佔位符表只有一個空白單元格。

* 對於預留位置表，您可以在片段建立時自訂下列屬性。

   * 列計數
   * 列計數
   * 每欄的頁首和頁尾
   * 各欄的類型（目標區域／欄位）
   * 每欄的寬度比

* 對於非預留位置表，可以自定義以下屬性：

   * 列計數
   * 列計數
   * 其他欄的頁首和頁尾
   * 每欄的寬度比

您可以在字母中巢狀內嵌片段。 這表示您可以在片段中新增片段。 Correponse Management解決方案可支援多達4個層級的函件巢狀結構：**Letter**->**片段**->**片段**->**片段**->**片段。**

如需在版面片段中使用靜態和動態表格的詳細範例，請參閱[包含範例檔案的範例：在字母](#examplewithsamplefiles)中使用靜態和動態表。

### 建立版面片段{#creating-a-layout-fragment}

1. 選擇「**建立** > **佈局片段**」。
1. 「對應管理」會顯示可用的XDP。 選擇您要作為版面片段基礎的XDP，然後點選&#x200B;**Next**。
1. 指定版面的下列資訊：

   * **標題（可選）:** 輸入版面片段的標題。標題不需要唯一，而且可以有特殊字元和非英文字元。 版面片段由標題（如果有的話）參照，例如縮圖和資產屬性。
   * **名稱：** 版面片段的唯一名稱。任何狀態下都不能有兩個資產（文字、條件或清單）具有相同的名稱。 在「名稱」欄位中，您只能輸入英文字元、數字和連字型大小。 「名稱」欄位會根據「標題」欄位自動填入。 在「標題」欄位中輸入的特殊字元、空格、數字和非英文字元將在「名稱」欄位中替換為連字元。 雖然「標題」欄位中的值會自動複製到「名稱」，但您可以編輯值。 此名稱會出現在「管理資產」使用者介面的清單中。
   * **說明（可選）**:顯示在「管理資產」使用者介面清單中的說明。
   * **標籤（可選）**:（可選）選擇要套用至條件的標籤。您也可以輸入新標籤的名稱並加以建立。

1. 點選「**表格**」標籤，並指定版面的下列資訊：

   * **配置**:選擇要配置的表。如果表是靜態表，則作為下拉清單中表名的尾碼為（靜態）；如果表是動態表，則作為尾碼為（動態）。靜態表包含固定的行數。 靜態表可以包含目標區域和欄位。 這些目標區域和欄位不能綁定到重複的DDE。 系結至表格儲存格的資料會決定動態表格的列數。

   * **行**:選取版面的列數。配置的行計數必須大於或等於原始行計數。
   * **欄**:選取版面的欄數。配置的列計數必須大於或等於原始列計數。

   對於每一列，都需要以下詳細資訊：

   * **頁首**:要為頁首顯示的文字
   * **頁尾**:要為頁尾顯示的文字
   * **類型**:其他欄的類型。欄位或目標區域。 對靜態佔位符表啟用類型。 類型可在欄層級定義，而不能在儲存格層級定義。 擴展列中的所有單元格類型都相同。 對於動態表，所有列均為欄位類型。 對於非佔位符表，不能定義附加列的類型。 在這種情況下，擴展列中的附加單元格類型與該行中最後一列的類型相同；而其他列中的儲存格類型與該欄中最後一個儲存格的類型相同。
   * **寬度比：** 表格欄寬的比例。

   如需在版面片段中使用靜態和動態表格的詳細範例，請參閱[包含範例檔案的範例：在字母](#examplewithsamplefiles)中使用靜態和動態表。

1. 點選&#x200B;**Save**。

### 將XDP上傳到通信管理{#upload-an-xdp-to-correspondence-management}

有關將XDP上載／導入到通信管理的說明，請參閱[將資產導入和導出到AEM Forms](/help/forms/using/import-export-forms-templates.md)。

### 最佳實務／秘訣與訣竅{#best-practices-tips-and-tricks-2}

#### 設定預設子表單綁定{#set-the-default-subform-binding}

在Designer中建立目標區域時，將所有新子表單的預設系結設為「無」會有所幫助。

要設定預設綁定：

1. 在設計器中，點選「**工具** > **選項** > **資料系結** > **子表單系結**」。

1. 在「新子表單的預設綁定」清單中，選擇&#x200B;**無資料綁定**。

這可確保使用「插入」>「子表單」命令或從「物件浮動視窗」拖放來插入的子表單，預設為「無」的系結。 這表示在預設下，任何新子表單都是目標區域，除非您新增內容、變更其系結設定，或以&quot;_int&quot;字尾命名子表單。

#### 第508節——符合{#section-compliance}

如果在「建立對應」使用者介面中建立的完成信函，會用來填入稍後的工作流程。 建立版面時，請遵循與第508節相關的建議。 否則，字母PDF會顯示，您可以忽略下列建議：

* 版面中的所有目標區域子表單和所有欄位都有Tab順序。
* 預設情況下，含標題的欄位符合508規範。 預設情況下，欄位的/field/assist/speak@priority屬性會設為「自訂」，這表示除非提供自訂的螢幕閱讀程式文字，否則螢幕閱讀程式會讀取欄位的標題。
* 沒有標題的欄位會指定工具提示，並指出螢幕閱讀者透過設定

`/field/assist/speak@priority="toolTip"` 和在中指定工具提示文本 `/field/assist/toolTip`。

#### Designer和Asset Configuration Manager {#date-formats-in-designer-and-asset-configuration-manager}中的日期格式

在設計器中設計佈局時，請確保日期欄位的格式與[Corresponce Management Configuration Properties](/help/forms/using/cm-configuration-properties.md)中「資料顯示格式」中指定的日期格式相匹配。 如需詳細資訊，請參閱設計人員說明中的「格式化欄位值和使用圖樣」。

#### 擷取日期範圍{#capturing-date-ranges}

處理日期組合（例如startDate - endDate）時，請使用單一子表單來確保在完成的字母中正確對齊，並將欄位數減至最少。

#### 設定表單級綁定{#setting-form-level-binding}

當版麵包含許多對應至單一XML元素的欄位和目標區域時，請使用表單層級系結並為每個元素建立個別節點。 在「對應管理」中對應資料時，會忽略在表單層級上系結的欄位。

#### 請勿在主版頁面{#do-not-use-subform-target-areas-in-a-master-page}中使用子表單目標區域

主版頁面中的子表單目標區域在「管理資產」使用者介面中不可見，且資料無法對應至它們。

#### 為目標區域選擇適當的位置和類型{#choosing-appropriate-positions-and-types-for-target-areas}

設計版面時，請謹慎選擇子表單。 如果版麵包含單一子表單，則可以是串流類型。 在子表單中定位欄位後，您可以用另一個子表單包住它，這樣包住的子表單也會流過，而且版面配置不會受到干擾。

#### 在主版頁面上放置欄位{#placing-fields-on-master-pages}

將欄位置於主版頁面時，請注意下列事項：

* 將主版頁面欄位的系結設為使用全域資料
* 請勿將欄位直接置於主版頁面的根PageArea下方。
* 在命名子表單中包覆欄位，並確保命名子表單的系結設為「使用名稱」。

## 使用佈局片段{#creating-tables-using-layout-fragments}建立表

許多字母模板包含表。 表可以是靜態的，例如術語和條件表，其中每行代表一個條件，每個部分都顯示在單獨的列中。 表格也可以是動態的，例如帳戶資訊，其中包含客戶名稱、帳戶ID、交易編號和交易金額等資訊。

* **靜態表**:表格有時會使用不同欄數的列來建立，例如詞語與條件表格。其中，每一行代表一個條件，而每個條件可以有不同的子部件。 每個部件都顯示在單獨的列中。
* **動態表格**:版面片段可將動態表格的欄位系結至系列DDE。在生成字母表行時，根據集合DDE的大小生成字母表行。

DD有一個收集元素Ontimeed_details，它有一個包含三個基本元素的複合元素：Optimeed_name、Optimeed_address和Optimeed_geder。
動態XDP也有相同的標題。 因此，您可以用上述DD欄位映射動態XDP欄位。

### 範例檔案範例：在字母{#examplewithsamplefiles}中使用靜態和動態表

此示例說明如何建立動態表和靜態表、將動態表綁定到DDE，然後建立包含這兩個表的字母。 使用此範例時，您可以從頭開始建立檔案，或使用步驟中提供的輸入檔案。

1. 建立要在示例中使用的資料字典(DD)，如圖中所示。

   然後選擇DD並匯出範例資料。 您取得的XML檔案包含Employee資料和Ontimeed_details的3個例項（預設會下載3個例項）。 您可以視需要新增或刪除)。 更新值，然後以DD匯入測試資料。 CMP檔案是軟體包，其中包含DD。 因此，將DD導入「通信管理」。

   如需使用資料字典和測試資料的詳細資訊，請參閱[資料字典](/help/forms/using/data-dictionary.md#p-working-with-test-data-p)。

   ![資料字典結構](assets/dd.jpeg)

   [取得檔案](assets/exportpackage_1431709897770.cmp.zip)

1. 在Designer中，建立兩個XDP（版面片段）:動態表和靜態表。 對於這兩種版面：

   * 向表列添加子表單。 請確定您已將表格的父子表格版面配置變更為溢排並移除表格中子表格的系結。
   * 新增子表單至表格儲存格。 請確定您已將表格的父子表格版面配置變更為溢排並移除表格中子表格的系結。

   或者，使用此步驟附加的靜態和動態XDP。

   如需使用版面片段的詳細資訊，請參閱[版面片段](#layoutfragments)。
如需有關設計版面的詳細資訊，請參閱[設計人員說明](https://help.adobe.com/en_US/AEMForms/6.1/DesignerHelp/)。

   [取得檔案](assets/static.xdp.zip)

   [取得檔案](assets/dynamic.xdp.zip)

1. 將XDP上傳到AEM Forms。
1. 根據動態XDP建立版面片段。 屬性的「表」(Table)頁籤顯示表是動態的(「配置」(Configuration For)欄位)。 行數(1)和列數(3)是從XDP/佈局片段派生的。

   此版面的欄位稍後會系結至匯入的DD，在字母中，會根據測試資料檔案（隨DD附加的XML資料檔案）中的記錄數，動態建立列數。

   ![建立版面片段畫面](assets/dynamictableproperties.png)

   按一下以開啟全尺寸影像

1. 根據靜態XDP建立版面片段。 屬性的「表」頁籤顯示表為靜態（「配置」欄位）。 行數(1)和列數(3)是從XDP/佈局片段派生的。

   您可以在此變更欄數和列數。 根據您在此螢幕中選擇的內容，靜態表格的行數和列數在使用此佈局建立的字母中保持不變。
   [ ![建立版面片段畫面](assets/statictableproperties.png)](assets/statictableproperties-1.png)

1. 使用其中的版面片段建立字母。 在字母中插入動態XDP時，請將其欄位與「資料字典」的收集元素綁定。

   有關建立字母和字母模板的詳細資訊，請參閱[建立字母](/help/forms/using/create-letter.md)。

1. 儲存信件並預覽。 當您預覽字母時，「資料字典」中的值會顯示在字母中。 對於動態表，有三行。 這是因為測試資料有這些列的3個記錄。

   對於靜態表，在建立佈局片段時有指定的行和列數。

   ![字母中的靜態表](assets/statictableletter.png)

   對於動態表，三列會根據測試資料檔案中的記錄數顯示。 這是因為在將版面新增至字母時，您在動態表格的欄位與資料字典的收集元素之間建立系結。 「名稱」、「位址」和「性別」值會從您使用的測試資料檔案中填入。

   ![字母中的動態表](assets/dynamictableletter.png)

## 建立文檔片段{#create-a-copy-of-a-document-fragment}的副本

若要快速建立具有類似現有檔案片段的屬性和內容的檔案片段，您可以複製並貼上它。

1. 從檔案片段清單中，選取一或多個檔案片段。 UI會顯示「複製」圖示。
1. 點選「 複製」。UI會顯示「貼上」圖示。 您也可以選擇在貼上之前進入資料夾。 不同的檔案夾可以包含具有相同名稱的資產。 有關資料夾的詳細資訊，請參閱[資料夾和組織資產](/help/forms/using/import-export-forms-templates.md#folders-and-organizing-assets)。
1. 點選「貼上」。 將出現「貼上」對話框。 如果您在同一位置複製和貼上檔案片段，系統會自動為新字母副本指派名稱和標題，但您可以編輯字母的標題和名稱。
1. 如果需要，請編輯要用來保存文檔片段副本的標題和名稱。
1. 點選「貼上」。 建立文檔片段的副本。

